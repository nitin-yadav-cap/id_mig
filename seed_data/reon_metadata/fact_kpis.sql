-- MySQL dump 10.13  Distrib 8.0.25, for macos11 (x86_64)
--
-- Host: localhost    Database: nightly_mod
-- ------------------------------------------------------
-- Server version	8.0.25

--
-- Dumping data for table `fact_kpis`
--

REPLACE INTO `fact_kpis` (`column_id`, `table_id`, `expression`, `type`, `is_reversible`, `primary_key_level`, `is_active`, `scope_id`, `last_computed_on`, `added_on`, `updated_on`, `id_str`, `column_id_str`, `table_id_str`) VALUES (7,1,'curr.bill_lineitems.org_level_visit_count := case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 and curr.bill_lineitems.dim_membership_id = 1  then __rankAndPartitionBy__ else 0 end;{partition_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_bill_outlier_status_id:::order_by=curr.bill_lineitems.dim_event_date_id,curr.bill_lineitems.dim_event_time_id,curr.bill_lineitems.bill_id} ','NON_INC_RANK',0,-1,0,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_org_level_visit_count_-1000','bill_lineitems_-1000_org_level_visit_count','bill_lineitems_-1000'),
(13,1,'curr.bill_lineitems.visit_count := case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 and curr.bill_lineitems.dim_membership_id = 1  then __rankAndPartitionBy__ else 0 end;{partition_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_bill_outlier_status_id:::order_by=curr.bill_lineitems.dim_event_date_id,curr.bill_lineitems.dim_event_time_id,curr.bill_lineitems.bill_id}','NON_INC_RANK',0,-1,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_visit_count_-1000','bill_lineitems_-1000_visit_count','bill_lineitems_-1000'),
(14,1,'curr.bill_lineitems.org_level_visit_day_count := case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 and curr.bill_lineitems.dim_membership_id = 1  then __rankAndPartitionBy__ else 0 end;{partition_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_bill_outlier_status_id:::order_by=curr.bill_lineitems.dim_event_date_id}','NON_INC_RANK',0,-1,0,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_org_level_visit_day_count_-1000','bill_lineitems_-1000_org_level_visit_day_count','bill_lineitems_-1000'),
(20,1,'curr.bill_lineitems.visit_day_count := case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 and curr.bill_lineitems.dim_membership_id = 1  then __rankAndPartitionBy__ else 0 end;{partition_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_bill_outlier_status_id:::order_by=curr.bill_lineitems.dim_event_date_id}','NON_INC_RANK',0,-1,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_visit_day_count_-1000','bill_lineitems_-1000_visit_day_count','bill_lineitems_-1000'),
(21,1,'curr.bill_lineitems.dim_org_level_repeat_bill_status_id := case when curr.bill_lineitems.dim_membership_id = 2 then -10003 when curr.bill_lineitems.org_level_visit_day_count = 1 AND curr.bill_lineitems.dim_membership_id = 1 then 1 else 2 end;','MAP',0,0,0,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_dim_org_level_repeat_bill_status_id_-1000','bill_lineitems_-1000_dim_org_level_repeat_bill_status_id','bill_lineitems_-1000'),
(27,1,'curr.bill_lineitems.dim_repeat_status_id := case when curr.bill_lineitems.dim_membership_id = 2 then -10003 when curr.bill_lineitems.visit_day_count = 1 AND curr.bill_lineitems.dim_membership_id = 1  then 1 else 2 end;','MAP',0,-1,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_dim_repeat_status_id_-1000','bill_lineitems_-1000_dim_repeat_status_id','bill_lineitems_-1000'),
(49,3,'curr.bill_dump_bill_lineitems.dim_bill_outlier_status_id :=case when inc.bill_dump_bill_lineitems.bill_amount > 100000 then 4 else 1 end;','MAP',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_dump_bill_lineitems_-1000_bill_dump_bill_lineitems_-1000_dim_bill_outlier_status_id_-1000','bill_dump_bill_lineitems_-1000_dim_bill_outlier_status_id','bill_dump_bill_lineitems_-1000'),
(64,3,'curr.bill_dump_bill_lineitems.dim_line_item_outlier_status_id := case when curr.bill_dump_bill_lineitems.line_item_amount > 1000 then 4 else 1 end;','MAP',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_dump_bill_lineitems_-1000_bill_dump_bill_lineitems_-1000_dim_line_item_outlier_status_id_-1000','bill_dump_bill_lineitems_-1000_dim_line_item_outlier_status_id','bill_dump_bill_lineitems_-1000'),
(72,4,'curr.coupons.dim_redeemed_status_id :=case when inc.coupons.redeemed_id != 0 then 2 else 1 end;','MAP',0,0,1,-1000,'2017-04-27 22:39:00','2017-02-27 16:14:53','2021-11-30 09:22:28','coupons_old_-1000__-1000','','coupons_old_-1000'),
(91,5,'curr.points.bill_id := inc.points.bill_iden;inc.points.bill_iden := first(inc.bill_lineitems.bill_id);','INC_REDUCE',0,0,1,-1000,'2017-06-16 03:45:00','2017-06-16 02:28:15','2021-11-30 09:22:28','points_-1000_points_-1000_bill_id_-1000','points_-1000_bill_id','points_-1000'),
(134,6,'curr.customer_summary.first_visit_basket_size := count(case when curr.bill_lineitems.visit_count = 1 and curr.bill_lineitems.line_item_id != 0 then curr.bill_lineitems.line_item_id else null end);{selection_where_clause=visit_count = 1}','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_first_visit_basket_size_-1000','customer_summary_-1000_first_visit_basket_size','customer_summary_-1000'),
(135,6,'curr.customer_summary.dim_last_purchased_till_id := max(named_struct(\"ref\",curr.bill_lineitems.visit_count,\"value\",curr.bill_lineitems.dim_event_zone_till_id)).value;{order_by=curr.bill_lineitems.visit_count:::asc=false}','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_last_purchased_till_id_-1000','customer_summary_-1000_dim_last_purchased_till_id','customer_summary_-1000'),
(135,6,'curr.customer_summary.dim_last_purchased_till_id := max(named_struct(\"ref\",curr.bill_lineitems.visit_count,\"value\",curr.bill_lineitems.dim_ordered_till_id)).value;{order_by=curr.bill_lineitems.visit_count:::asc=false}','NON_INC_REDUCE',0,0,1,-998,'2020-09-03 18:31:17','2017-02-27 10:44:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_last_purchased_till_id_-998','customer_summary_-1000_dim_last_purchased_till_id','customer_summary_-1000'),
(136,6,'curr.customer_summary.number_of_visit_days := max(curr.bill_lineitems.visit_day_count);','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_number_of_visit_days_-1000','customer_summary_-1000_number_of_visit_days','customer_summary_-1000'),
(137,6,'curr.customer_summary.returned_bill_amount := curr.customer_summary.returned_bill_amount + nvl(inc.customer_summary.sum_returned_billamount,0);inc.customer_summary.sum_returned_billamount := sum(return_sum);{insert=case when first(curr.return_bill_lineitem.dim_membership_id) = 1 and first(curr.return_bill_lineitem.dim_returned_type_id) = 1 then first(curr.return_bill_lineitem.bill_amount) else 0 end AS return_sum:::update=case when first(curr.return_bill_lineitem.dim_membership_id) = 1 and first(curr.return_bill_lineitem.dim_returned_type_id[1]) = 1 then first(curr.return_bill_lineitem.bill_amount[1])- first(curr.return_bill_lineitem.bill_amount[0]) else 0 end AS return_sum:::group_by=curr.return_bill_lineitem.dim_membership_id,curr.return_bill_lineitem.bill_id};','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_returned_bill_amount_-1000','customer_summary_-1000_returned_bill_amount','customer_summary_-1000'),
(142,6,'curr.customer_summary.first_visit_bill_amount :=case when first(curr.bill_lineitems.visit_count) = 1 then first(curr.bill_lineitems.bill_amount) else 0 end;{order_by=curr.bill_lineitems.visit_count:::asc=true:::selection_where_clause=visit_count = 1}','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_first_visit_bill_amount_-1000','customer_summary_-1000_first_visit_bill_amount','customer_summary_-1000'),
(143,6,'curr.customer_summary.dim_last_bill_date_id := case when curr.customer_summary.dim_last_bill_date_id > nvl(inc.customer_summary.last_bill,0) then curr.customer_summary.dim_last_bill_date_id else nvl(inc.customer_summary.last_bill, -10003) end;inc.customer_summary.last_bill := max(case when inc.bill_lineitems.dim_bill_outlier_status_id = 1 then inc.bill_lineitems.dim_event_date_id else NULL end);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_last_bill_date_id_-1000','customer_summary_-1000_dim_last_bill_date_id','customer_summary_-1000'),
(144,6,'curr.customer_summary.average_spent_per_visit := curr.customer_summary.total_bill_amount/(case when curr.customer_summary.number_of_visits > 0 then curr.customer_summary.number_of_visits else 1 end);','MAP',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_average_spent_per_visit_-1000','customer_summary_-1000_average_spent_per_visit','customer_summary_-1000'),
(145,6,'curr.customer_summary.redeemed_voucher_count := curr.customer_summary.redeemed_voucher_count + inc.customer_summary.redeemed_count;inc.customer_summary.redeemed_count := count(case when curr.coupons.dim_coupon_event_type_id = 2 and curr.coupons.event_id is not null then 1 else null end);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_redeemed_voucher_count_-1000','customer_summary_-1000_redeemed_voucher_count','customer_summary_-1000'),
(150,6,'curr.customer_summary.number_of_visits := max(curr.bill_lineitems.visit_count);','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_number_of_visits_-1000','customer_summary_-1000_number_of_visits','customer_summary_-1000'),
(151,6,'curr.customer_summary.dim_first_bill_date_id := case when (curr.customer_summary.dim_first_bill_date_id IN (0, -10001, -10002, -10003)) and nvl(inc.customer_summary.first_bill,0) = 0 then -10003 when (curr.customer_summary.dim_first_bill_date_id IN (0, -10001, -10002, -10003))  then nvl(inc.customer_summary.first_bill, -10003) when curr.customer_summary.dim_first_bill_date_id > 0 AND nvl(inc.customer_summary.first_bill,0) < curr.customer_summary.dim_first_bill_date_id and nvl(inc.customer_summary.first_bill,0) != 0 then nvl(inc.customer_summary.first_bill, -10003) else curr.customer_summary.dim_first_bill_date_id end;inc.customer_summary.first_bill := min(case when inc.bill_lineitems.dim_bill_outlier_status_id = 1 then inc.bill_lineitems.dim_event_date_id else NULL end);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_first_bill_date_id_-1000','customer_summary_-1000_dim_first_bill_date_id','customer_summary_-1000'),
(152,6,'curr.customer_summary.dim_first_redeemption_date_id := case when (curr.customer_summary.dim_first_redeemption_date_id IN (0, -10001, -10002, -10003) ) and nvl(inc.customer_summary.first_redeemption,0) = 0 then -10003 when (curr.customer_summary.dim_first_redeemption_date_id IN (0, -10001, -10002, -10003) ) then nvl(inc.customer_summary.first_redeemption, -10003) when curr.customer_summary.dim_first_redeemption_date_id > 0 AND nvl(inc.customer_summary.first_redeemption,0) < curr.customer_summary.dim_first_redeemption_date_id and nvl(inc.customer_summary.first_redeemption,0) != 0 then inc.customer_summary.first_redeemption else curr.customer_summary.dim_first_redeemption_date_id end;inc.customer_summary.first_redeemption := min(case when inc.coupons.dim_coupon_event_type_id = 2 then inc.coupons.dim_event_date_id else NULL end);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_first_redeemption_date_id_-1000','customer_summary_-1000_dim_first_redeemption_date_id','customer_summary_-1000'),
(153,6,'curr.customer_summary.dim_customer_lapse_status_id := case when curr.customer_summary.dim_last_bill_date_id <= 0 then -10003 when (datediff(date(now()),\'1969-12-31\') - curr.customer_summary.dim_last_bill_date_id) > 90 and curr.customer_summary.dim_last_bill_date_id > 0 then 2 else 1 end;','MAP',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_customer_lapse_status_id_-1000','customer_summary_-1000_dim_customer_lapse_status_id','customer_summary_-1000'),
(158,6,'curr.customer_summary.sku_purchased := curr.customer_summary.sku_purchased + nvl(inc.customer_summary.sku_qty, 0);inc.customer_summary.sku_qty := sum(qty);{insert=case when inc.bill_lineitems.line_item_id != 0 and inc.bill_lineitems.dim_bill_outlier_status_id = 1 then inc.bill_lineitems.quantity else 0 end  AS qty:::update=case when inc.bill_lineitems.line_item_id != 0 and inc.bill_lineitems.dim_bill_outlier_status_id[1] = 1 then inc.bill_lineitems.quantity[1] - inc.bill_lineitems.quantity[0] else 0 end  AS qty};','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_sku_purchased_-1000','customer_summary_-1000_sku_purchased','customer_summary_-1000'),
(159,6,'curr.customer_summary.average_spent_per_sku := curr.customer_summary.total_line_item_amount/(case when curr.customer_summary.sku_purchased >0 then curr.customer_summary.sku_purchased else 1 end);','MAP',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_average_spent_per_sku_-1000','customer_summary_-1000_average_spent_per_sku','customer_summary_-1000'),
(160,6,'curr.customer_summary.dim_last_redeemption_date_id := case when curr.customer_summary.dim_last_redeemption_date_id > nvl(inc.customer_summary.last_redeemption,0) then curr.customer_summary.dim_last_redeemption_date_id else nvl(inc.customer_summary.last_redeemption, -10003) end;inc.customer_summary.last_redeemption := max(case when inc.coupons.dim_coupon_event_type_id = 2 then inc.coupons.dim_event_date_id else NULL end);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_last_redeemption_date_id_-1000','customer_summary_-1000_dim_last_redeemption_date_id','customer_summary_-1000'),
(161,6,'curr.customer_summary.returned_bill_count := curr.customer_summary.returned_bill_count + nvl(inc.customer_summary.count_returned, 0);inc.customer_summary.count_returned := count(distinct return);{insert=case when curr.return_bill_lineitem.dim_membership_id = 1 and curr.return_bill_lineitem.dim_returned_type_id = 1 then curr.return_bill_lineitem.bill_id else null end AS return:::update=NULL AS return}','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_returned_bill_count_-1000','customer_summary_-1000_returned_bill_count','customer_summary_-1000'),
(195,1,'curr.transactions.year := year(date_add(\'1969-12-31\',cast(curr.transactions.dim_event_date_id as int)));','MAP',0,-1,1,-1000,'2017-10-30 00:08:13','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_year_-1000','bill_lineitems_-1000_year','bill_lineitems_-1000'),
(196,2,'curr.return_transactions.year := year(date_add(\'1969-12-31\',cast(curr.return_transactions.dim_event_date_id as int)));','MAP',0,0,1,-1000,'2017-04-17 20:44:15','2017-02-27 16:14:53','2021-11-30 09:22:28','return_bill_lineitem_-1000_return_bill_lineitem_-1000_year_-1000','return_bill_lineitem_-1000_year','return_bill_lineitem_-1000'),
(197,3,'curr.bill_dump.year := year(date_add(\'1969-12-31\',cast(curr.bill_dump.dim_event_date_id as int)));','MAP',0,0,1,-1000,'2017-10-30 00:08:13','2017-02-27 16:14:53','2021-11-30 09:22:28','bill_dump_bill_lineitems_-1000_bill_dump_bill_lineitems_-1000_year_-1000','bill_dump_bill_lineitems_-1000_year','bill_dump_bill_lineitems_-1000'),
(198,4,'curr.vouchers.year := year(date_add(\'1969-12-31\',cast(curr.vouchers.dim_issual_date_id as int)));','MAP',0,0,1,-1000,'2017-10-30 00:08:13','2017-02-27 16:14:53','2021-11-30 09:22:28','coupons_old_-1000_coupons_old_-1000_year_-1000','coupons_old_-1000_year','coupons_old_-1000'),
(199,5,'curr.points.year := year(date_add(\'1969-12-31\',cast(curr.points.dim_event_date_id as int)));','MAP',0,0,1,-1000,'2017-10-30 00:08:13','2017-02-27 16:14:53','2021-11-30 09:22:28','points_-1000_points_-1000_year_-1000','points_-1000_year','points_-1000'),
(200,6,'curr.customer_summary.year := year(date_add(\'1969-12-31\',cast(curr.customer_summary.dim_event_date_id as int)));','MAP',0,0,1,-1000,'2017-04-17 20:38:32','2017-02-27 16:14:53','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_year_-1000','customer_summary_-1000_year','customer_summary_-1000'),
(241,8,'curr.contact_info.dim_event_zone_till_id := case when dim_communication_type_id in (3,4) then dimension.users.registered_till_id else curr.contact_info.sent_till_id end;','MAP',0,0,0,-1000,'2018-01-15 07:09:55','2018-01-15 07:09:55','2021-11-30 09:22:28','contact_info_-1000_contact_info_-1000_dim_event_zone_till_id_-1000','contact_info_-1000_dim_event_zone_till_id','contact_info_-1000'),
(247,8,'curr.contact_info.dim_delivery_status_id := case when inc.contact_info.delivery_status IS NULL AND  curr.contact_info.dim_communication_type_id = 4 THEN -10003 WHEN  inc.contact_info.delivery_status IS NULL AND  curr.contact_info.dim_communication_type_id != 4 THEN -10001 else  inc.contact_info.delivery_status end ; inc.contact_info.delivery_status := first(curr.nsadmin_messages.dim_delivery_status_id); ','INC_REDUCE',0,0,0,-1000,'2017-07-24 01:12:00','2017-03-08 03:34:47','2021-11-30 09:22:28','contact_info_-1000_contact_info_-1000_dim_delivery_status_id_-1000','contact_info_-1000_dim_delivery_status_id','contact_info_-1000'),
(248,8,'curr.contact_info.message_count := curr.nsadmin_messages.message_count;{pk_join_clause=false}','MAP',0,0,0,-1000,'2017-07-24 01:12:00','2017-03-08 03:34:21','2021-11-30 09:22:28','contact_info_-1000_contact_info_-1000_message_count_-1000','contact_info_-1000_message_count','contact_info_-1000'),
(250,8,'curr.contact_info.total_link_click_count := sum(curr.email_click_stats.clicks);','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-03-08 03:35:18','2021-11-30 09:22:28','contact_info_-1000_contact_info_-1000_total_link_click_count_-1000','contact_info_-1000_total_link_click_count','contact_info_-1000'),
(284,11,'curr.response_info.dim_delivery_status_id := nvl(first(curr.contact_info.dim_delivery_status_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2017-07-24 01:12:00','2017-03-26 06:08:40','2021-11-30 09:22:28','response_info_-1000_response_info_-1000_dim_delivery_status_id_-1000','response_info_-1000_dim_delivery_status_id','response_info_-1000'),
(294,6,'curr.customer_summary.total_bill_amount := curr.customer_summary.total_bill_amount + nvl(inc.customer_summary.sum_billamount,0);inc.customer_summary.sum_billamount := sum(bill_sum);{insert=case when first(curr.bill_lineitems.dim_bill_outlier_status_id) = 1 then first(curr.bill_lineitems.bill_amount) else 0 end AS bill_sum:::update=case when first(curr.bill_lineitems.dim_bill_outlier_status_id[1]) = 1 then first(curr.bill_lineitems.bill_amount[1])-first(curr.bill_lineitems.bill_amount[0]) else 0 end AS bill_sum:::group_by=curr.bill_lineitems.dim_membership_id,curr.bill_lineitems.bill_id};','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-03-28 15:50:56','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_total_bill_amount_-1000','customer_summary_-1000_total_bill_amount','customer_summary_-1000'),
(295,6,'curr.customer_summary.total_line_item_amount := curr.customer_summary.total_line_item_amount + nvl(inc.customer_summary.sum_lineitem_amount,0);inc.customer_summary.sum_lineitem_amount := sum(lineitem_sum);{insert=case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then curr.bill_lineitems.line_item_amount else 0 end AS lineitem_sum:::update=case when curr.bill_lineitems.dim_bill_outlier_status_id[1] = 1 then curr.bill_lineitems.line_item_amount[1] - curr.bill_lineitems.line_item_amount[0] else 0 end AS lineitem_sum};','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-03-28 15:54:50','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_total_line_item_amount_-1000','customer_summary_-1000_total_line_item_amount','customer_summary_-1000'),
(297,6,'curr.customer_summary.total_returned_line_item_amount := curr.customer_summary.total_returned_line_item_amount + nvl(inc.customer_summary.sum_returned_billamount,0);inc.customer_summary.sum_returned_billamount := sum(return_lineitem_sum);{insert=case when curr.return_bill_lineitem.dim_membership_id = 1 then curr.return_bill_lineitem.line_item_amount else 0 end AS return_lineitem_sum:::update=case when curr.return_bill_lineitem.dim_membership_id = 1 then curr.return_bill_lineitem.line_item_amount[1]-curr.return_bill_lineitem.line_item_amount[0] else 0 end AS return_lineitem_sum};','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-03-28 15:54:50','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_total_returned_line_item_amount_-1000','customer_summary_-1000_total_returned_line_item_amount','customer_summary_-1000'),
(298,6,'curr.customer_summary.total_bill_count := curr.customer_summary.total_bill_count + nvl(inc.customer_summary.count_bill,0);inc.customer_summary.count_bill := count(distinct bill_count);{insert=case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then curr.bill_lineitems.bill_id else null end AS bill_count:::update=NULL AS bill_count}','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-03-28 15:50:56','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_total_bill_count_-1000','customer_summary_-1000_total_bill_count','customer_summary_-1000'),
(300,6,'curr.customer_summary.skus_returned := curr.customer_summary.skus_returned + nvl(inc.customer_summary.sku,0);inc.customer_summary.sku := count(distinct lineitem);{insert=case when inc.return_bill_lineitem.line_item_id != 0  then inc.return_bill_lineitem.line_item_id else null end  AS lineitem:::update=null  AS lineitem};','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-03-28 15:55:45','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_skus_returned_-1000','customer_summary_-1000_skus_returned','customer_summary_-1000'),
(311,12,'curr.coupons.dim_expiry_date_id := case when curr.coupons.dim_coupon_event_type_id  = 1 then 10000 * YEAR(least(case when dimension.coupon_series.expiry_strategy_type = \"MONTHS\" then add_months(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), dimension.coupon_series.expiry_strategy_value) when  dimension.coupon_series.expiry_strategy_type = \"MONTHS_END\" then last_day(add_months(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), dimension.coupon_series.expiry_strategy_value)) when  dimension.coupon_series.expiry_strategy_type = \"DAYS\" then date_add(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), cast(dimension.coupon_series.expiry_strategy_value as int)) else NULL end, date(least(dimension.coupon_series.valid_till_date, dimension.coupon_series.owner_valid_till_date)))) + 100 * MONTH(least(case when dimension.coupon_series.expiry_strategy_type = \"MONTHS\" then add_months(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), dimension.coupon_series.expiry_strategy_value) when  dimension.coupon_series.expiry_strategy_type = \"MONTHS_END\" then last_day(add_months(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), dimension.coupon_series.expiry_strategy_value)) when  dimension.coupon_series.expiry_strategy_type = \"DAYS\" then date_add(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), cast(dimension.coupon_series.expiry_strategy_value as int)) else NULL end, date(least(dimension.coupon_series.valid_till_date, dimension.coupon_series.owner_valid_till_date)))) + DAY(least(case when dimension.coupon_series.expiry_strategy_type = \"MONTHS\" then add_months(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), dimension.coupon_series.expiry_strategy_value) when  dimension.coupon_series.expiry_strategy_type = \"MONTHS_END\" then last_day(add_months(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), dimension.coupon_series.expiry_strategy_value)) when  dimension.coupon_series.expiry_strategy_type = \"DAYS\" then date_add(to_date(concat(curr.coupons.dim_event_date_id div 10000, \'-\', ( curr.coupons.dim_event_date_id div 100 ) % 100, \'-\', curr.coupons.dim_event_date_id % 100  )), cast(dimension.coupon_series.expiry_strategy_value as int)) else NULL end, date(least(dimension.coupon_series.valid_till_date, dimension.coupon_series.owner_valid_till_date)))) when curr.coupons.dim_coupon_event_type_id  = 2 then 10000 * YEAR(least(case when dimension.coupon_series.expiry_strategy_type = \"MONTHS\" then add_months(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), dimension.coupon_series.expiry_strategy_value) when  dimension.coupon_series.expiry_strategy_type = \"MONTHS_END\" then last_day(add_months(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), dimension.coupon_series.expiry_strategy_value)) when  dimension.coupon_series.expiry_strategy_type = \"DAYS\" then date_add(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), cast(dimension.coupon_series.expiry_strategy_value as int)) else NULL end, date(least(dimension.coupon_series.valid_till_date, dimension.coupon_series.owner_valid_till_date)))) + 100 * MONTH(least(case when dimension.coupon_series.expiry_strategy_type = \"MONTHS\" then add_months(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), dimension.coupon_series.expiry_strategy_value) when  dimension.coupon_series.expiry_strategy_type = \"MONTHS_END\" then last_day(add_months(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), dimension.coupon_series.expiry_strategy_value)) when  dimension.coupon_series.expiry_strategy_type = \"DAYS\" then date_add(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), cast(dimension.coupon_series.expiry_strategy_value as int)) else NULL end, date(least(dimension.coupon_series.valid_till_date, dimension.coupon_series.owner_valid_till_date)))) + DAY(least(case when dimension.coupon_series.expiry_strategy_type = \"MONTHS\" then add_months(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), dimension.coupon_series.expiry_strategy_value) when  dimension.coupon_series.expiry_strategy_type = \"MONTHS_END\" then last_day(add_months(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), dimension.coupon_series.expiry_strategy_value)) when  dimension.coupon_series.expiry_strategy_type = \"DAYS\" then date_add(to_date(concat(curr.coupons.dim_issual_date_id div 10000, \'-\', ( curr.coupons.dim_issual_date_id div 100 ) % 100, \'-\', curr.coupons.dim_issual_date_id % 100  )), cast(dimension.coupon_series.expiry_strategy_value as int)) ELSE NULL end, date(least(dimension.coupon_series.valid_till_date, dimension.coupon_series.owner_valid_till_date))))  else 0 end;','MAP',0,0,1,-1000,'2017-07-24 01:12:00','2017-02-27 16:14:53','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_expiry_date_id_-1000','coupons_-1000_dim_expiry_date_id','coupons_-1000'),
(313,12,'curr.coupons.dim_issual_date_id := case when inc.coupons.dim_issual_date_id <=0 then inc.coupons.issual_date else inc.coupons.dim_issual_date_id end; inc.coupons.issual_date := first(curr.coupons.dim_event_date_id);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-02 08:44:01','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_issual_date_id_-1000','coupons_-1000_dim_issual_date_id','coupons_-1000'),
(314,12,'curr.coupons.dim_issual_time_id := case when inc.coupons.dim_issual_time_id <= 0 then  inc.coupons.issual_time else inc.coupons.dim_issual_time_id end ;inc.coupons.issual_time := first(curr.coupons.dim_event_time_id);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-02 08:44:01','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_issual_time_id_-1000','coupons_-1000_dim_issual_time_id','coupons_-1000'),
(315,12,'curr.coupons.dim_issual_type_id := case when inc.coupons.dim_issual_type_id <= 0 then  inc.coupons.issual_type else inc.coupons.dim_issual_type_id end; inc.coupons.issual_type := first(curr.coupons.dim_coupon_issual_type_id);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-02 08:46:54','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_issual_type_id_-1000','coupons_-1000_dim_issual_type_id','coupons_-1000'),
(316,12,'curr.coupons.dim_issued_to_user_id := case when inc.coupons.dim_issued_to_user_id <= 0 then  inc.coupons.issued_user else inc.coupons.dim_issued_to_user_id end; inc.coupons.issued_user := first(curr.coupons.dim_event_user_id);','INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-02 08:46:54','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_issued_to_user_id_-1000','coupons_-1000_dim_issued_to_user_id','coupons_-1000'),
(320,8,'curr.contact_info.dim_unsubscription_status_id := case when curr.contact_info.unsubscribed = \'OPTOUT\' then 1 else 2 end;','MAP',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-13 22:33:26','2021-11-30 09:22:28','contact_info_-1000_contact_info_-1000_dim_unsubscription_status_id_-1000','contact_info_-1000_dim_unsubscription_status_id','contact_info_-1000'),
(334,11,'curr.response_info.dim_repeat_status_id := nvl(first(curr.bill_lineitems.dim_repeat_status_id),-10003);','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-20 02:51:05','2021-11-30 09:22:28','response_info_-1000_response_info_-1000_dim_repeat_status_id_-1000','response_info_-1000_dim_repeat_status_id','response_info_-1000'),
(338,11,'curr.response_info.total_link_click_count := nvl(first(curr.contact_info.total_link_click_count), -10003);','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-20 02:51:05','2021-11-30 09:22:28','response_info_-1000_response_info_-1000_total_link_click_count_-1000','response_info_-1000_total_link_click_count','response_info_-1000'),
(339,11,'curr.response_info.dim_unsubscription_status_id := nvl(first(curr.contact_info.dim_unsubscription_status_id), -10003);','NON_INC_REDUCE',0,0,1,-1000,'2017-07-24 01:12:00','2017-05-13 22:33:26','2021-11-30 09:22:28','response_info_-1000_response_info_-1000_dim_unsubscription_status_id_-1000','response_info_-1000_dim_unsubscription_status_id','response_info_-1000'),
(358,5,'curr.points.event_bill_amount := inc.points.bill_amt;inc.points.bill_amt := first(inc.bill_lineitems.bill_amount);','INC_REDUCE',0,0,0,-1000,'2017-07-24 01:12:00','2017-05-14 19:00:13','2021-11-30 09:22:28','points_-1000_points_-1000_event_bill_amount_-1000','points_-1000_event_bill_amount','points_-1000'),
(360,6,'curr.customer_summary.line_item_count := curr.customer_summary.line_item_count + nvl(inc.customer_summary.sku, 0);inc.customer_summary.sku := count(distinct lineitem);{insert=case when inc.bill_lineitems.line_item_id != 0 and inc.bill_lineitems.dim_bill_outlier_status_id = 1 then inc.bill_lineitems.line_item_id else null end  AS lineitem:::update=null  AS lineitem};','INC_REDUCE',1,0,1,-1000,'2017-07-24 01:12:00','2017-07-06 13:04:13','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_line_item_count_-1000','customer_summary_-1000_line_item_count','customer_summary_-1000'),
(361,12,'curr.coupons.dim_campaign_group_id := case when inc.coupons.dim_campaign_group_id <= 0 then inc.coupons.campaign_group else inc.coupons.dim_campaign_group_id end; inc.coupons.campaign_group := first(curr.coupons.dim_issual_campaign_group_id);','INC_REDUCE',0,0,1,-1000,'2018-01-18 06:52:01','2018-01-18 06:52:01','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_campaign_group_id_-1000','coupons_-1000_dim_campaign_group_id','coupons_-1000'),
(369,13,'curr.ffc_fact.dim_direction_id :=  case  when curr.ffc_fact.direction = \'0\' then 1 when curr.ffc_fact.direction = \'1\' then 2 end;','MAP',0,0,1,-1000,'2017-09-19 01:36:41','2017-09-19 01:36:41','2021-11-30 09:22:28','ffc_fact_-1000_ffc_fact_-1000_dim_direction_id_-1000','ffc_fact_-1000_dim_direction_id','ffc_fact_-1000'),
(375,13,'curr.ffc_fact.dim_group_size_id :=  case  when curr.ffc_fact.dim_walkin_type_id= 2  then  case when curr.ffc_fact.size_text = \'1\' then 1  when curr.ffc_fact.size_text = \'2\' then 2  when curr.ffc_fact.size_text = \'3\' then 3 when curr.ffc_fact.size_text = \'3+\' then 4 end else -10003 end;','MAP',0,0,1,-1000,'2017-09-19 01:36:41','2017-09-19 01:36:41','2021-11-30 09:22:28','ffc_fact_-1000_ffc_fact_-1000_dim_group_size_id_-1000','ffc_fact_-1000_dim_group_size_id','ffc_fact_-1000'),
(377,11,'curr.response_info.redeemed_points := nvl(first(curr.bill_lineitems.redeemed_points),-10003);','NON_INC_REDUCE',0,0,1,-1000,'2017-10-30 00:08:13','2017-10-18 19:17:09','2021-11-30 09:22:28','response_info_-1000_response_info_-1000_redeemed_points_-1000','response_info_-1000_redeemed_points','response_info_-1000'),
(378,6,'curr.customer_summary.dim_lapsation_date_id := case when curr.customer_summary.dim_last_bill_date_id > 0 then 10000 * YEAR (date_add(concat(substring(curr.customer_summary.dim_last_bill_date_id,0,4),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,5,2),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,7,2)), cast(config.lapsation_days as int))) + 100 * MONTH(date_add(concat(substring(curr.customer_summary.dim_last_bill_date_id,0,4),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,5,2),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,7,2)), cast(config.lapsation_days as int))) + DAY(date_add(concat(substring(curr.customer_summary.dim_last_bill_date_id,0,4),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,5,2),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,7,2)), cast(config.lapsation_days as int)))  else -10003 end;','MAP',0,0,1,-1000,'2017-10-30 00:08:13','2017-10-18 19:17:09','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_lapsation_date_id_-1000','customer_summary_-1000_dim_lapsation_date_id','customer_summary_-1000'),
(379,6,'curr.customer_summary.latency := case when curr.customer_summary.number_of_visit_days - 1 > 0 then datediff(concat(substring(curr.customer_summary.dim_last_bill_date_id,0,4),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,5,2),\'-\',substring(curr.customer_summary.dim_last_bill_date_id,7,2)), concat(substring(curr.customer_summary.dim_first_bill_date_id,0,4),\'-\',substring(curr.customer_summary.dim_first_bill_date_id,5,2),\'-\',substring(curr.customer_summary.dim_first_bill_date_id,7,2)))/(curr.customer_summary.number_of_visit_days - 1) else 0 end;','MAP',0,0,1,-1000,'2017-10-30 00:08:13','2017-10-18 19:17:09','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_latency_-1000','customer_summary_-1000_latency','customer_summary_-1000'),
(383,6,'curr.customer_summary.dim_preferred_store_id := case when  __rowNumberAndPartitionBy__ = 1 and first(curr.bill_lineitems.dim_event_zone_till_id) > 0 then dimension.zone_tills.store else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=sum(curr.bill_lineitems.quantity),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.zone_tills.store:::where_clause=dim_preferred_store_id is not null}','NON_INC_RANK',0,0,1,-1000,'2017-10-30 00:08:13','2017-10-18 19:17:09','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_store_id_-1000','customer_summary_-1000_dim_preferred_store_id','customer_summary_-1000'),
(383,6,'curr.customer_summary.dim_preferred_store_id := case when  __rowNumberAndPartitionBy__ = 1 and first(curr.bill_lineitems.dim_event_zone_till_id) > 0 then dimension.zone_tills.store else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=count(curr.bill_lineitems.bill_id),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.zone_tills.store:::where_clause=dim_preferred_store_id is not null}','NON_INC_RANK',0,0,1,-582,'2020-02-03 00:27:58','2020-02-03 00:27:58','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_store_id_-582','customer_summary_-1000_dim_preferred_store_id','customer_summary_-1000'),
(383,6,'curr.customer_summary.dim_preferred_store_id := case when  __rowNumberAndPartitionBy__ = 1 and first(curr.bill_lineitems.dim_event_zone_till_id) > 0 then dimension.zone_tills.store else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=count(distinct curr.bill_lineitems.bill_id),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.zone_tills.store:::where_clause=dim_preferred_store_id is not null}','NON_INC_RANK',0,0,0,150330,'2019-12-19 18:39:31','2019-12-19 18:39:31','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_store_id_150330','customer_summary_-1000_dim_preferred_store_id','customer_summary_-1000'),
(383,6,'curr.customer_summary.dim_preferred_store_id := case when  __rowNumberAndPartitionBy__ = 1 and first(curr.bill_lineitems.dim_event_zone_till_id) > 0 then dimension.zone_tills.store else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=count(distinct curr.bill_lineitems.bill_id),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.zone_tills.store:::where_clause=dim_preferred_store_id is not null}','NON_INC_RANK',0,0,0,150404,'2019-12-19 18:39:31','2019-12-19 18:39:31','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_store_id_150404','customer_summary_-1000_dim_preferred_store_id','customer_summary_-1000'),
(383,6,'curr.customer_summary.dim_preferred_store_id := case when  __rowNumberAndPartitionBy__ = 1 and first(curr.bill_lineitems.dim_event_zone_till_id) > 0 then dimension.zone_tills.store else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=count(distinct curr.bill_lineitems.bill_id),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.zone_tills.store:::where_clause=dim_preferred_store_id is not null}','NON_INC_RANK',0,0,0,150405,'2019-12-19 18:39:31','2019-12-19 18:39:31','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_store_id_150405','customer_summary_-1000_dim_preferred_store_id','customer_summary_-1000'),
(383,6,'curr.customer_summary.dim_preferred_store_id := case when  __rowNumberAndPartitionBy__ = 1 and first(curr.bill_lineitems.dim_event_zone_till_id) > 0 then dimension.zone_tills.store else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=count(distinct curr.bill_lineitems.bill_id),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.zone_tills.store:::where_clause=dim_preferred_store_id is not null}','NON_INC_RANK',0,0,0,150406,'2019-12-19 18:39:31','2019-12-19 18:39:31','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_store_id_150406','customer_summary_-1000_dim_preferred_store_id','customer_summary_-1000'),
(383,6,'curr.customer_summary.dim_preferred_store_id := case when  __rowNumberAndPartitionBy__ = 1 and first(curr.bill_lineitems.dim_event_zone_till_id) > 0 then dimension.zone_tills.store else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=count(distinct curr.bill_lineitems.bill_id),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.zone_tills.store:::where_clause=dim_preferred_store_id is not null}','NON_INC_RANK',0,0,0,150738,'2019-12-19 18:39:31','2019-12-19 18:39:31','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_store_id_150738','customer_summary_-1000_dim_preferred_store_id','customer_summary_-1000'),
(384,1,'curr.bill_lineitems.days_since_last_visit := datediff(concat(substring(first(curr.bill_lineitems.dim_event_date_id),0,4),\'-\',substring(first(curr.bill_lineitems.dim_event_date_id),5,2),\'-\',substring(first(curr.bill_lineitems.dim_event_date_id),7,2)), concat(substring(__lagAndPartitionBy__,0,4),\'-\',substring(__lagAndPartitionBy__,5,2),\'-\',substring(__lagAndPartitionBy__,7,2)));{partition_by=first(curr.bill_lineitems.dim_event_user_id),first(curr.bill_lineitems.dim_bill_outlier_status_id):::order_by=first(curr.bill_lineitems.dim_event_date_id):::asc=true:::group_by=curr.bill_lineitems.dim_membership_id,curr.bill_lineitems.bill_id:::inside_expr=first(dim_event_date_id),1,first(dim_event_date_id)}','NON_INC_RANK',0,-1,1,-1000,'2017-10-30 00:08:13','2017-10-18 19:17:09','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_days_since_last_visit_-1000','bill_lineitems_-1000_days_since_last_visit','bill_lineitems_-1000'),
(385,2,'curr.return_bill_lineitem.dim_parent_line_item_outlier_status_id := nvl(first(curr.bill_lineitems.dim_line_item_outlier_status_id),-10003);','NON_INC_REDUCE',0,0,1,-1000,'2017-10-30 00:08:13','2017-10-26 01:43:28','2021-11-30 09:22:28','return_bill_lineitem_-1000_return_bill_lineitem_-1000_dim_parent_line_item_outlier_status_id_-1000','return_bill_lineitem_-1000_dim_parent_line_item_outlier_status_id','return_bill_lineitem_-1000'),
(385,2,'curr.return_bill_lineitem.dim_parent_line_item_outlier_status_id := curr.return_bill_lineitem.dim_bill_outlier_status_id;','MAP',0,0,1,-878,NULL,'2020-05-04 19:43:28','2021-11-30 09:22:28','return_bill_lineitem_-1000_return_bill_lineitem_-1000_dim_parent_line_item_outlier_status_id_-878','return_bill_lineitem_-1000_dim_parent_line_item_outlier_status_id','return_bill_lineitem_-1000'),
(386,2,'curr.return_bill_lineitem.dim_parent_bill_outlier_status_id := nvl(first(curr.bill_lineitems.dim_bill_outlier_status_id),-10003);','NON_INC_REDUCE',0,0,1,-1000,'2017-10-30 00:08:13','2017-10-26 01:43:28','2021-11-30 09:22:28','return_bill_lineitem_-1000_return_bill_lineitem_-1000_dim_parent_bill_outlier_status_id_-1000','return_bill_lineitem_-1000_dim_parent_bill_outlier_status_id','return_bill_lineitem_-1000'),
(386,2,'curr.return_bill_lineitem.dim_parent_bill_outlier_status_id := curr.return_bill_lineitem.dim_bill_outlier_status_id;','MAP',0,0,1,-878,NULL,'2020-05-04 19:43:28','2021-11-30 09:22:28','return_bill_lineitem_-1000_return_bill_lineitem_-1000_dim_parent_bill_outlier_status_id_-878','return_bill_lineitem_-1000_dim_parent_bill_outlier_status_id','return_bill_lineitem_-1000'),
(405,1,'curr.bill_lineitems.dim_time_preference_id := case when curr.bill_lineitems.dim_event_time_id between config.breakfast_time then 1 when curr.bill_lineitems.dim_event_time_id between config.lunch_time then 2 when curr.bill_lineitems.dim_event_time_id between config.snacks_time then 3 when curr.bill_lineitems.dim_event_time_id between config.dinner_time then 4 when curr.bill_lineitems.dim_event_time_id between config.late_dinner_time then 5 else -10003 end;','MAP',0,-1,1,-998,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_dim_time_preference_id_-998','bill_lineitems_-1000_dim_time_preference_id','bill_lineitems_-1000'),
(406,1,'curr.bill_lineitems.dim_day_type_id := case when dimension.date.day_of_week_no in (config.weekdays) then 1 else 2 end;','MAP',0,-1,1,-998,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_dim_day_type_id_-998','bill_lineitems_-1000_dim_day_type_id','bill_lineitems_-1000'),
(407,6,'curr.customer_summary.preferred_brand := case when  __rowNumberAndPartitionBy__ = 1 then dimension.inventory_items.config.inventory_attr_level else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=sum(curr.bill_lineitems.quantity),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,dimension.inventory_items.config.inventory_attr_level:::where_clause=preferred_brand is not null:::selection_where_clause=config.inventory_attr_level NOT IN (config.inventory_filter)}','NON_INC_RANK',0,0,1,-998,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_preferred_brand_-998','customer_summary_-1000_preferred_brand','customer_summary_-1000'),
(408,6,'curr.customer_summary.dim_preferred_time_preference_id := case when  __rowNumberAndPartitionBy__ = 1 then curr.bill_lineitems.dim_time_preference_id  else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=sum(curr.bill_lineitems.quantity),max(curr.bill_lineitems.dim_event_date_id),max(curr.bill_lineitems.dim_event_time_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_time_preference_id:::where_clause=dim_preferred_time_preference_id is not null}','NON_INC_RANK',0,0,1,-998,'2017-11-08 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_time_preference_id_-998','customer_summary_-1000_dim_preferred_time_preference_id','customer_summary_-1000'),
(409,6,'curr.customer_summary.dim_preferred_day_type_id := case when  __rowNumberAndPartitionBy__ = 1 then curr.bill_lineitems.dim_day_type_id  else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=sum(curr.bill_lineitems.quantity),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_day_type_id:::where_clause=dim_preferred_day_type_id is not null}','NON_INC_RANK',0,0,1,-998,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_day_type_id_-998','customer_summary_-1000_dim_preferred_day_type_id','customer_summary_-1000'),
(410,6,'curr.customer_summary.dim_preferred_booking_type_id := case when  __rowNumberAndPartitionBy__ = 1 then curr.bill_lineitems.dim_booking_type_id  else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=sum(curr.bill_lineitems.quantity),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_booking_type_id:::where_clause=dim_preferred_booking_type_id is not null:::selection_where_clause=dim_booking_type_id > 0}','NON_INC_RANK',0,0,1,-1000,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_booking_type_id_-1000','customer_summary_-1000_dim_preferred_booking_type_id','customer_summary_-1000'),
(411,1,'curr.bill_lineitems.group_size := curr.bill_lineitems.group_size + nvl(inc.bill_lineitems.size,0); inc.bill_lineitems.size := sum(g_size);{insert=case when dimension.inventory_item_attributes.group_size > 0 then dimension.inventory_item_attributes.group_size * curr.bill_lineitems.quantity else 0 end AS g_size:::update=NULL AS g_size}','INC_REDUCE',1,-1,1,-998,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_group_size_-998','bill_lineitems_-1000_group_size','bill_lineitems_-1000'),
(412,6,'curr.customer_summary.average_group_size := curr.customer_summary.total_group_size/(case when curr.customer_summary.total_bill_count > 0 then curr.customer_summary.total_bill_count else 1 end);','MAP',0,0,1,-998,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_average_group_size_-998','customer_summary_-1000_average_group_size','customer_summary_-1000'),
(413,6,'curr.customer_summary.total_group_size := curr.customer_summary.total_group_size + nvl(inc.customer_summary.sum_size,0);inc.customer_summary.sum_size := sum(bill_group);{insert=case when first(curr.bill_lineitems.dim_bill_outlier_status_id) = 1 then first(curr.bill_lineitems.group_size) else 0 end AS bill_group:::update=NULL AS bill_group:::group_by=curr.bill_lineitems.dim_membership_id,curr.bill_lineitems.bill_id};','INC_REDUCE',1,0,1,-998,'2017-11-07 13:00:00','2017-11-07 13:00:00','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_total_group_size_-998','customer_summary_-1000_total_group_size','customer_summary_-1000'),
(421,15,'curr.slab_change_log.slab_name := case when curr.slab_change_log.dim_customer_slab_id > 0 then dimension.customer_slab.slab_name else  \'\' end;','MAP',0,0,1,-1000,'2017-11-14 13:00:00','2017-11-14 13:00:00','2021-11-30 09:22:28','slab_change_log_-1000_slab_change_log_-1000_slab_name_-1000','slab_change_log_-1000_slab_name','slab_change_log_-1000'),
(423,6,'curr.customer_summary.dim_preferred_order_channel_id := case when  __rowNumberAndPartitionBy__ = 1 then curr.bill_lineitems.dim_order_channel_id  else null end;{partition_by=curr.bill_lineitems.dim_event_user_id:::order_by=sum(curr.bill_lineitems.quantity),max(curr.bill_lineitems.dim_event_date_id):::asc=false:::group_by=curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_order_channel_id:::where_clause=dim_preferred_order_channel_id is not null:::selection_where_clause=dim_order_channel_id > 0 }','NON_INC_RANK',0,0,1,-1000,'2017-11-10 13:00:00','2017-11-10 13:00:00','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_preferred_order_channel_id_-1000','customer_summary_-1000_dim_preferred_order_channel_id','customer_summary_-1000'),
(478,6,'curr.customer_summary.dim_first_purchased_till_id := case when first(curr.bill_lineitems.visit_count) = 1 then first(curr.bill_lineitems.dim_event_zone_till_id) else -10001 end;{order_by=curr.bill_lineitems.visit_count:::asc=true:::selection_where_clause=visit_count = 1}','NON_INC_REDUCE',0,0,1,-1000,'2018-01-04 02:08:08','2018-01-04 02:08:08','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_first_purchased_till_id_-1000','customer_summary_-1000_dim_first_purchased_till_id','customer_summary_-1000'),
(478,6,'curr.customer_summary.dim_first_purchased_till_id := case when first(curr.bill_lineitems.visit_count) = 1 then first(curr.bill_lineitems.dim_ordered_till_id) else -10001 end;{order_by=curr.bill_lineitems.visit_count:::asc=true:::selection_where_clause=visit_count = 1}','NON_INC_REDUCE',0,0,1,-998,'2020-09-03 18:31:17','2018-01-03 20:38:08','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_first_purchased_till_id_-998','customer_summary_-1000_dim_first_purchased_till_id','customer_summary_-1000'),
(478,6,'curr.customer_summary.dim_first_purchased_till_id := min(named_struct(\"con1\",case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then 0 else 1 end,\"ref1\",curr.bill_lineitems.dim_event_date_id,\"ref2\",curr.bill_lineitems.dim_event_time_id,\"ref3\",curr.bill_lineitems.bill_id,\"value\",curr.bill_lineitems.dim_event_zone_till_id)).value;','NON_INC_REDUCE',0,0,1,-555,'2018-01-04 02:08:08','2018-01-04 02:08:08','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_first_purchased_till_id_-555','customer_summary_-1000_dim_first_purchased_till_id','customer_summary_-1000'),
(555,21,'curr.wechat_qrscan_fact.event_rank := __rankAndPartitionBy__ ;{partition_by=curr.wechat_qrscan_fact.dim_event_user_id:::order_by=curr.wechat_qrscan_fact.dim_event_date_id,curr.wechat_qrscan_fact.dim_event_time_id}','NON_INC_RANK',0,0,1,-1000,'2018-03-05 01:18:47','2018-03-05 01:18:47','2021-11-30 09:22:28','wechat_qrscan_fact_-1000_wechat_qrscan_fact_-1000_event_rank_-1000','wechat_qrscan_fact_-1000_event_rank','wechat_qrscan_fact_-1000'),
(572,23,'curr.registration_event.registration_event_rank := case when curr.registration_event.dim_state_id = 1 then __rankAndPartitionBy__ else 0 end;{partition_by=curr.registration_event.dim_event_user_id,curr.registration_event.dim_state_id:::order_by=curr.registration_event.dim_event_date_id,curr.registration_event.dim_event_time_id}','NON_INC_RANK',0,0,1,-1000,'2018-04-20 00:01:02','2018-04-20 00:01:02','2021-11-30 09:22:28','registration_event_-1000_registration_event_-1000_registration_event_rank_-1000','registration_event_-1000_registration_event_rank','registration_event_-1000'),
(573,13,'curr.ffc_fact.is_max_direction := case when __rowNumberAndPartitionBy__ = 1 then 1 else 0 end;{partition_by=curr.ffc_fact.dim_event_date_id,curr.ffc_fact.dim_entity_type_id,dimension.zone_tills.store:::order_by=sum(curr.ffc_fact.count):::asc=false:::group_by=curr.ffc_fact.dim_event_date_id,dimension.zone_tills.store,curr.ffc_fact.direction,curr.ffc_fact.dim_entity_type_id:::lookup_by=curr.ffc_fact.dim_device_date_id,curr.ffc_fact.dim_event_zone_till_id:::where_clause=is_max_direction is not null:::selection_where_clause=dim_walkin_type_id = 1 AND dim_entity_type_id = 1 }','NON_INC_RANK',0,0,1,-1000,'2018-05-25 06:16:37','2018-05-25 06:16:37','2021-11-30 09:22:28','ffc_fact_-1000_ffc_fact_-1000_is_max_direction_-1000','ffc_fact_-1000_is_max_direction','ffc_fact_-1000'),
(659,12,'curr.coupons.dim_issual_zone_till_id := case when curr.coupons.dim_coupon_issual_type_id = 2 then dimension.users.registered_till_id else curr.coupons.dim_event_zone_till_id end;','MAP',0,0,1,-1000,'2018-06-22 00:37:16','2018-06-22 00:37:16','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_issual_zone_till_id_-1000','coupons_-1000_dim_issual_zone_till_id','coupons_-1000'),
(661,13,'curr.ffc_fact.dim_event_time_id := case when dimension.zone_tills.timezone IN (\'NOT-CAPTURED\',\'INVALID\',\'NOT-APPLICABLE\') then curr.ffc_fact.dim_device_time_id else hour(from_utc_timestamp(from_unixtime( (curr.ffc_fact.event_timestamp + (to_unix_timestamp(to_utc_timestamp(\'1970-01-01\',\'config.TZ\'))*1000) )/ 1000), dimension.zone_tills.timezone)) * 60 + minute(from_utc_timestamp(from_unixtime((curr.ffc_fact.event_timestamp + (to_unix_timestamp(to_utc_timestamp(\'1970-01-01\',\'config.TZ\'))*1000) ) / 1000), dimension.zone_tills.timezone)) end;','MAP',0,0,1,-1000,'2018-06-22 00:55:47','2018-06-22 00:55:47','2021-11-30 09:22:28','ffc_fact_-1000_ffc_fact_-1000_dim_event_time_id_-1000','ffc_fact_-1000_dim_event_time_id','ffc_fact_-1000'),
(662,13,'curr.ffc_fact.dim_event_date_id := case when dimension.zone_tills.timezone IN (\'NOT-CAPTURED\',\'INVALID\',\'NOT-APPLICABLE\') then curr.ffc_fact.dim_device_date_id else 10000*YEAR(from_utc_timestamp(from_unixtime((curr.ffc_fact.event_timestamp + (to_unix_timestamp(to_utc_timestamp(\'1970-01-01\',\'config.TZ\'))*1000) ) / 1000), dimension.zone_tills.timezone)) +100*MONTH(from_utc_timestamp(from_unixtime((curr.ffc_fact.event_timestamp + (to_unix_timestamp(to_utc_timestamp(\'1970-01-01\',\'config.TZ\'))*1000) ) / 1000), dimension.zone_tills.timezone)) + DAY(from_utc_timestamp(from_unixtime((curr.ffc_fact.event_timestamp + (to_unix_timestamp(to_utc_timestamp(\'1970-01-01\',\'config.TZ\'))*1000) ) / 1000), dimension.zone_tills.timezone)) end;','MAP',0,0,1,-1000,'2018-06-22 00:55:47','2018-06-22 00:55:47','2021-11-30 09:22:28','ffc_fact_-1000_ffc_fact_-1000_dim_event_date_id_-1000','ffc_fact_-1000_dim_event_date_id','ffc_fact_-1000'),
(663,1,'curr.bill_lineitems.total_quantity := curr.bill_lineitems.total_quantity + nvl(inc.bill_lineitems.t_quantity,0); inc.bill_lineitems.t_quantity := sum(t_qty);{insert= curr.bill_lineitems.quantity AS t_qty:::update=(curr.bill_lineitems.quantity[1] - curr.bill_lineitems.quantity[0]) AS g_size}','INC_REDUCE',1,-1,1,-1000,'2018-07-06 01:30:20','2018-07-06 01:30:20','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_total_quantity_-1000','bill_lineitems_-1000_total_quantity','bill_lineitems_-1000'),
(664,6,'curr.customer_summary.last_visit_bill_amount :=  max(named_struct(\"ref\",curr.bill_lineitems.visit_count,\"value\",curr.bill_lineitems.bill_amount)).value;{order_by=curr.bill_lineitems.visit_count:::asc=false}','NON_INC_REDUCE',0,0,1,-1000,'2018-07-06 01:30:20','2018-07-06 01:30:20','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_last_visit_bill_amount_-1000','customer_summary_-1000_last_visit_bill_amount','customer_summary_-1000'),
(664,6,'curr.customer_summary.last_visit_bill_amount :=  max(named_struct(\"con1\",case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then 1 else 0 end,\"ref1\",curr.bill_lineitems.dim_event_date_id,\"ref2\",curr.bill_lineitems.dim_event_time_id,\"ref3\",curr.bill_lineitems.bill_id,\"value\",curr.bill_lineitems.bill_amount)).value;','NON_INC_REDUCE',0,0,1,-555,'2018-07-06 01:30:20','2018-07-06 01:30:20','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_last_visit_bill_amount_-555','customer_summary_-1000_last_visit_bill_amount','customer_summary_-1000'),
(666,5,'curr.points.dim_awarded_points_promotion_id := case when curr.points.dim_points_awarded_type_id != 1 then  inc.points.awarded_promo_id else curr.points.dim_awarded_points_promotion_id end ;inc.points.awarded_promo_id := first(case when  curr.points.dim_points_event_type_id = 1 then curr.points.dim_points_promotion_id else null end, true);','INC_REDUCE',0,0,1,-1000,'2018-07-06 01:30:20','2018-07-06 01:30:20','2021-11-30 09:22:28','points_-1000_points_-1000_dim_awarded_points_promotion_id_-1000','points_-1000_dim_awarded_points_promotion_id','points_-1000'),
(733,24,'curr.payment_details_fact.central_gst := nvl(first(curr.bill_lineitems.central_gst), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_central_gst_-1000','payment_details_fact_-994_central_gst','payment_details_fact_-994'),
(734,24,'curr.payment_details_fact.state_gst := nvl(first(curr.bill_lineitems.state_gst), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_state_gst_-1000','payment_details_fact_-994_state_gst','payment_details_fact_-994'),
(735,24,'curr.payment_details_fact.ship_zip := nvl(first(curr.bill_lineitems.ship_zip), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_zip_-992','payment_details_fact_-994_ship_zip','payment_details_fact_-994'),
(736,24,'curr.payment_details_fact.quantity := nvl(first(curr.bill_lineitems.quantity), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_quantity_-1000','payment_details_fact_-994_quantity','payment_details_fact_-994'),
(737,24,'curr.payment_details_fact.bill_amount := nvl(first(curr.bill_lineitems.bill_amount), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_bill_amount_-1000','payment_details_fact_-994_bill_amount','payment_details_fact_-994'),
(738,24,'curr.payment_details_fact.ship_state := nvl(first(curr.bill_lineitems.ship_state), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_state_-992','payment_details_fact_-994_ship_state','payment_details_fact_-994'),
(739,24,'curr.payment_details_fact.bill_discount := nvl(first(curr.bill_lineitems.bill_discount), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_bill_discount_-1000','payment_details_fact_-994_bill_discount','payment_details_fact_-994'),
(740,24,'curr.payment_details_fact.ship_phone := nvl(first(curr.bill_lineitems.ship_phone), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_phone_-992','payment_details_fact_-994_ship_phone','payment_details_fact_-994'),
(741,24,'curr.payment_details_fact.ship_last_name := nvl(first(curr.bill_lineitems.ship_last_name), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_last_name_-992','payment_details_fact_-994_ship_last_name','payment_details_fact_-994'),
(742,24,'curr.payment_details_fact.ship_first_name := nvl(first(curr.bill_lineitems.ship_first_name), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_first_name_-992','payment_details_fact_-994_ship_first_name','payment_details_fact_-994'),
(743,24,'curr.payment_details_fact.ship_email := nvl(first(curr.bill_lineitems.ship_email), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_email_-992','payment_details_fact_-994_ship_email','payment_details_fact_-994'),
(744,24,'curr.payment_details_fact.dim_ship_country_id := nvl(first(curr.bill_lineitems.dim_ship_country_id), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_ship_country_id_-992','payment_details_fact_-994_dim_ship_country_id','payment_details_fact_-994'),
(745,24,'curr.payment_details_fact.ship_city := nvl(first(curr.bill_lineitems.ship_city), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_city_-992','payment_details_fact_-994_ship_city','payment_details_fact_-994'),
(746,24,'curr.payment_details_fact.ship_address_line2 := nvl(first(curr.bill_lineitems.ship_address_line2), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_address_line2_-992','payment_details_fact_-994_ship_address_line2','payment_details_fact_-994'),
(747,24,'curr.payment_details_fact.ship_address_line1 := nvl(first(curr.bill_lineitems.ship_address_line1), -10003);','NON_INC_REDUCE',0,0,0,-992,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_ship_address_line1_-992','payment_details_fact_-994_ship_address_line1','payment_details_fact_-994'),
(748,24,'curr.payment_details_fact.tax_amount := nvl(first(curr.bill_lineitems.tax_amount), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_tax_amount_-1000','payment_details_fact_-994_tax_amount','payment_details_fact_-994'),
(749,24,'curr.payment_details_fact.metal_purity := nvl(first(curr.bill_lineitems.metal_purity), -10003);','NON_INC_REDUCE',0,0,0,-993,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_metal_purity_-993','payment_details_fact_-994_metal_purity','payment_details_fact_-994'),
(750,24,'curr.payment_details_fact.integrated_gst := nvl(first(curr.bill_lineitems.integrated_gst), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_integrated_gst_-1000','payment_details_fact_-994_integrated_gst','payment_details_fact_-994'),
(751,24,'curr.payment_details_fact.gross_weight := nvl(first(curr.bill_lineitems.gross_weight), -10003);','NON_INC_REDUCE',0,0,0,-993,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_gross_weight_-993','payment_details_fact_-994_gross_weight','payment_details_fact_-994'),
(752,24,'curr.payment_details_fact.dim_event_user_id := nvl(first(curr.bill_lineitems.dim_event_user_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_event_user_id_-1000','payment_details_fact_-994_dim_event_user_id','payment_details_fact_-994'),
(753,24,'curr.payment_details_fact.dim_nps_id := nvl(first(curr.bill_lineitems.dim_nps_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_nps_id_-1000','payment_details_fact_-994_dim_nps_id','payment_details_fact_-994'),
(754,24,'curr.payment_details_fact.dim_order_date_id := nvl(first(curr.bill_lineitems.dim_order_date_id), -10003);','NON_INC_REDUCE',0,0,0,-998,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_order_date_id_-998','payment_details_fact_-994_dim_order_date_id','payment_details_fact_-994'),
(755,24,'curr.payment_details_fact.dim_delivery_time_id := nvl(first(curr.bill_lineitems.dim_delivery_time_id), -10003);','NON_INC_REDUCE',0,0,0,-994,'2018-07-19 22:44:10','2018-07-19 22:44:10','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_delivery_time_id_-994','payment_details_fact_-994_dim_delivery_time_id','payment_details_fact_-994'),
(756,24,'curr.payment_details_fact.dim_delivery_date_id := nvl(first(curr.bill_lineitems.dim_delivery_date_id), -10003);','NON_INC_REDUCE',0,0,0,-994,'2018-07-19 22:44:10','2018-07-19 22:44:10','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_delivery_date_id_-994','payment_details_fact_-994_dim_delivery_date_id','payment_details_fact_-994'),
(757,24,'curr.payment_details_fact.dim_order_channel_id := nvl(first(curr.bill_lineitems.dim_order_channel_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-19 22:44:10','2018-07-19 22:44:10','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_order_channel_id_-1000','payment_details_fact_-994_dim_order_channel_id','payment_details_fact_-994'),
(758,24,'curr.payment_details_fact.dim_booking_type_id := nvl(first(curr.bill_lineitems.dim_booking_type_id), -10003);','NON_INC_REDUCE',0,0,0,-998,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_booking_type_id_-998','payment_details_fact_-994_dim_booking_type_id','payment_details_fact_-994'),
(759,24,'curr.payment_details_fact.dim_ordered_till_id := nvl(first(curr.bill_lineitems.dim_ordered_till_id), -10003);','NON_INC_REDUCE',0,0,0,-998,'2018-07-19 22:44:10','2018-07-19 22:44:10','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_ordered_till_id_-998','payment_details_fact_-994_dim_ordered_till_id','payment_details_fact_-994'),
(760,24,'curr.payment_details_fact.dim_source_type_id := nvl(first(curr.bill_lineitems.dim_source_type_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_source_type_id_-1000','payment_details_fact_-994_dim_source_type_id','payment_details_fact_-994'),
(761,24,'curr.payment_details_fact.dim_loyalty_type_id := nvl(first(curr.bill_lineitems.dim_loyalty_type_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_loyalty_type_id_-1000','payment_details_fact_-994_dim_loyalty_type_id','payment_details_fact_-994'),
(762,24,'curr.payment_details_fact.dim_event_date_id := nvl(first(curr.bill_lineitems.dim_event_date_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_event_date_id_-1000','payment_details_fact_-994_dim_event_date_id','payment_details_fact_-994'),
(763,24,'curr.payment_details_fact.dim_event_zone_till_id := nvl(first(curr.bill_lineitems.dim_event_zone_till_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_event_zone_till_id_-1000','payment_details_fact_-994_dim_event_zone_till_id','payment_details_fact_-994'),
(764,24,'curr.payment_details_fact.dim_event_time_id := nvl(first(curr.bill_lineitems.dim_event_time_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_event_time_id_-1000','payment_details_fact_-994_dim_event_time_id','payment_details_fact_-994'),
(765,24,'curr.payment_details_fact.dim_order_time_id := nvl(first(curr.bill_lineitems.dim_order_time_id), -10003);','NON_INC_REDUCE',0,0,0,-998,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_order_time_id_-998','payment_details_fact_-994_dim_order_time_id','payment_details_fact_-994'),
(818,6,'curr.customer_summary.max_bill_amount := max(case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then curr.bill_lineitems.bill_amount else NULL end);','NON_INC_REDUCE',0,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_max_bill_amount_-1000','customer_summary_-1000_max_bill_amount','customer_summary_-1000'),
(819,6,'curr.customer_summary.max_bill_count_in_week := case when curr.customer_summary.max_bill_count_in_week > nvl(inc.customer_summary.max_bill_count_week,0) then curr.customer_summary.max_bill_count_in_week else nvl(inc.customer_summary.max_bill_count_week,0) end;inc.customer_summary.max_bill_count_week := max(bill_countweek);{insert=count(distinct case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then curr.bill_lineitems.bill_id else NULL end) AS bill_countweek:::update=count(null) AS bill_countweek:::group_by=curr.bill_lineitems.dim_membership_id,curr.bill_lineitems.dim_event_user_id,dimension.date.week_of_year,dimension.date.year};','INC_REDUCE',1,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_max_bill_count_in_week_-1000','customer_summary_-1000_max_bill_count_in_week','customer_summary_-1000'),
(820,6,'curr.customer_summary.max_bill_count_in_day := case when curr.customer_summary.max_bill_count_in_day > nvl(inc.customer_summary.max_bill_count,0) then curr.customer_summary.max_bill_count_in_day else nvl(inc.customer_summary.max_bill_count,0) end;inc.customer_summary.max_bill_count := max(bill_countday);{insert=count(distinct case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then curr.bill_lineitems.bill_id else NULL end) AS bill_countday:::update=count(null) AS bill_countday:::group_by=curr.bill_lineitems.dim_membership_id,curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_event_date_id};','INC_REDUCE',1,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_max_bill_count_in_day_-1000','customer_summary_-1000_max_bill_count_in_day','customer_summary_-1000'),
(821,6,'curr.customer_summary.redeemed_visit_days := curr.customer_summary.redeemed_visit_days  + nvl(inc.customer_summary.redeemed_visitdays,0);inc.customer_summary.redeemed_visitdays := count(distinct rvd);{insert=case when curr.points.dim_points_event_type_id = 2 and curr.points.dim_deduction_type_id = 4 then curr.points.dim_event_date_id else NULL end AS rvd:::update=null AS rvd};','INC_REDUCE',1,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_redeemed_visit_days_-1000','customer_summary_-1000_redeemed_visit_days','customer_summary_-1000'),
(822,6,'curr.customer_summary.redemption_latency := case when curr.customer_summary.redeemed_visit_days - 1 > 0 then datediff(concat(substring(curr.customer_summary.dim_last_points_redemption_date_id,0,4),\'-\',substring(curr.customer_summary.dim_last_points_redemption_date_id,5,2),\'-\',substring(curr.customer_summary.dim_last_points_redemption_date_id,7,2)), concat(substring(curr.customer_summary.dim_first_points_redemption_date_id,0,4),\'-\',substring(curr.customer_summary.dim_first_points_redemption_date_id,5,2),\'-\',substring(curr.customer_summary.dim_first_points_redemption_date_id,7,2)))/(curr.customer_summary.redeemed_visit_days - 1) else 0 end;','MAP',0,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_redemption_latency_-1000','customer_summary_-1000_redemption_latency','customer_summary_-1000'),
(823,6,'curr.customer_summary.redeemed_visits := curr.customer_summary.redeemed_visits  + nvl(inc.customer_summary.redeemed_visit,0);inc.customer_summary.redeemed_visit := count(distinct rv);{insert=case when curr.points.dim_points_event_type_id = 2 and curr.points.dim_deduction_type_id = 4 then curr.points.event_id else NULL end AS rv:::update=null AS rv};','INC_REDUCE',1,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_redeemed_visits_-1000','customer_summary_-1000_redeemed_visits','customer_summary_-1000'),
(824,6,'curr.customer_summary.points_awarded_days := curr.customer_summary.points_awarded_days  + nvl(inc.customer_summary.points_awardeds,0);inc.customer_summary.points_awardeds := count(distinct pad);{insert=case when curr.points.dim_points_event_type_id = 1  then curr.points.dim_event_date_id else NULL end AS pad:::update=null AS pad};','INC_REDUCE',1,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_points_awarded_days_-1000','customer_summary_-1000_points_awarded_days','customer_summary_-1000'),
(825,6,'curr.customer_summary.redeemed_rate := curr.customer_summary.redeemed_visit_days/(case when curr.customer_summary.points_awarded_days > 0 then curr.customer_summary.points_awarded_days else 1 end);','MAP',0,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_redeemed_rate_-1000','customer_summary_-1000_redeemed_rate','customer_summary_-1000'),
(826,6,'curr.customer_summary.total_points_redeemed := curr.customer_summary.total_points_redeemed  + nvl(inc.customer_summary.redeemed_sum,0);inc.customer_summary.redeemed_sum := sum(rs);{insert=case when curr.points.dim_points_event_type_id = 2 and curr.points.dim_deduction_type_id = 4 then curr.points.deducted_points else NULL end AS rs:::update=null AS rs};','INC_REDUCE',1,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_total_points_redeemed_-1000','customer_summary_-1000_total_points_redeemed','customer_summary_-1000'),
(827,6,'curr.customer_summary.dim_first_points_redemption_date_id := case when (curr.customer_summary.dim_first_points_redemption_date_id IN (0, -10001, -10002, -10003)) and nvl(inc.customer_summary.first_redemption,0) = 0 then -10003 when (curr.customer_summary.dim_first_points_redemption_date_id IN (0, -10001, -10002, -10003))  then nvl(inc.customer_summary.first_redemption, -10003) when curr.customer_summary.dim_first_points_redemption_date_id > 0 AND nvl(inc.customer_summary.first_redemption,0) < curr.customer_summary.dim_first_points_redemption_date_id and nvl(inc.customer_summary.first_redemption,0) != 0 then nvl(inc.customer_summary.first_redemption, -10003) else curr.customer_summary.dim_first_points_redemption_date_id end;inc.customer_summary.first_redemption := min(case when inc.points.dim_points_event_type_id = 2 and inc.points.dim_deduction_type_id = 4 then inc.points.dim_event_date_id else NULL end);','INC_REDUCE',0,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_first_points_redemption_date_id_-1000','customer_summary_-1000_dim_first_points_redemption_date_id','customer_summary_-1000'),
(828,6,'curr.customer_summary.dim_last_points_redemption_date_id := case when curr.customer_summary.dim_last_points_redemption_date_id > nvl(inc.customer_summary.last_redemption,0) then curr.customer_summary.dim_last_points_redemption_date_id else nvl(inc.customer_summary.last_redemption, -10003) end;inc.customer_summary.last_redemption := max(case when inc.points.dim_points_event_type_id = 2 and inc.points.dim_deduction_type_id = 4 then inc.points.dim_event_date_id else NULL end);','INC_REDUCE',0,0,1,-1000,'2018-08-03 02:16:07','2018-08-03 02:16:07','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_last_points_redemption_date_id_-1000','customer_summary_-1000_dim_last_points_redemption_date_id','customer_summary_-1000'),
(838,12,'curr.coupons.coupon_code := inc.coupons.coupon_src; inc.coupons.coupon_src := first(regexp_replace(curr.coupons.coupon_code_src, \'__.*\', \'\'));','INC_REDUCE',0,0,1,-1000,'2018-08-02 03:50:28','2018-08-02 03:50:28','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_coupon_code_-1000','coupons_-1000_coupon_code','coupons_-1000'),
(847,6,'curr.customer_summary.has_spike_bill := case when curr.customer_summary.number_of_visits > 1 and  curr.customer_summary.max_bill_amount > 10 * (curr.customer_summary.total_bill_amount - curr.customer_summary.max_bill_amount)/(case when curr.customer_summary.number_of_visits - 1 > 0 then curr.customer_summary.number_of_visits - 1  else 1 end) then 1 else 0 end;','MAP',0,0,1,-1000,'2018-08-17 02:19:19','2018-08-17 02:19:19','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_has_spike_bill_-1000','customer_summary_-1000_has_spike_bill','customer_summary_-1000'),
(848,6,'curr.customer_summary.lifetime_purchased_rank :=  __rankAndPartitionBy__ ;{order_by=curr.customer_summary.lifetime_purchased:::asc=false}','NON_INC_RANK',0,0,0,-1000,'2018-08-17 02:19:19','2018-08-17 02:19:19','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_lifetime_purchased_rank_-1000','customer_summary_-1000_lifetime_purchased_rank','customer_summary_-1000'),
(849,6,'curr.customer_summary.max_zones_with_billing_on_same_day := case when curr.customer_summary.max_zones_with_billing_on_same_day > nvl(inc.customer_summary.max_bill_count_zone,0) then curr.customer_summary.max_zones_with_billing_on_same_day else nvl(inc.customer_summary.max_bill_count_zone,0) end;inc.customer_summary.max_bill_count_zone := max(bill_countzone);{insert=count(distinct case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then dimension.zone_tills.config.zone_tills_level else NULL end) AS bill_countzone:::update=count(null) AS bill_countzone:::group_by=curr.bill_lineitems.dim_membership_id,curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_event_date_id};','INC_REDUCE',1,0,1,-1000,'2018-08-17 02:19:19','2018-08-17 02:19:19','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_max_zones_with_billing_on_same_day_-1000','customer_summary_-1000_max_zones_with_billing_on_same_day','customer_summary_-1000'),
(877,24,'curr.payment_details_fact.dim_bill_outlier_status_id := nvl(first(curr.bill_lineitems.dim_bill_outlier_status_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 07:24:55','2018-07-06 07:24:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_bill_outlier_status_id_-1000','payment_details_fact_-994_dim_bill_outlier_status_id','payment_details_fact_-994'),
(878,24,'curr.payment_details_fact.dim_cashier_id := nvl(first(curr.bill_lineitems.dim_cashier_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 07:24:55','2018-07-06 07:24:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_cashier_id_-1000','payment_details_fact_-994_dim_cashier_id','payment_details_fact_-994'),
(879,24,'curr.payment_details_fact.dim_repeat_status_id := nvl(first(curr.bill_lineitems.dim_repeat_status_id), -10003);','NON_INC_REDUCE',0,0,1,-1000,'2018-07-06 07:24:55','2018-07-06 07:24:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_repeat_status_id_-1000','payment_details_fact_-994_dim_repeat_status_id','payment_details_fact_-994'),
(880,24,'curr.payment_details_fact.dim_org_level_repeat_bill_status_id := nvl(first(curr.bill_lineitems.dim_org_level_repeat_bill_status_id), -10003);','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 07:24:55','2018-07-06 07:24:55','2021-11-30 09:22:28','payment_details_fact_-994_payment_details_fact_-994_dim_org_level_repeat_bill_status_id_-1000','payment_details_fact_-994_dim_org_level_repeat_bill_status_id','payment_details_fact_-994'),
(883,6,'curr.customer_summary.dim_repeat_status_id := case when sum(case when curr.bill_lineitems.dim_repeat_status_id > 1 then 1 else 0 end) > 0 then 2 else 1 end;','NON_INC_REDUCE',0,0,1,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_repeat_status_id_-1000','customer_summary_-1000_dim_repeat_status_id','customer_summary_-1000'),
(884,6,'curr.customer_summary.dim_first_awarded_date_id := case when (curr.customer_summary.dim_first_awarded_date_id IN (0, -10001, -10002, -10003)) and nvl(inc.customer_summary.first_awarded,0) = 0 then -10003 when (curr.customer_summary.dim_first_awarded_date_id IN (0, -10001, -10002, -10003)) then nvl(inc.customer_summary.first_awarded, -10003) when curr.customer_summary.dim_first_awarded_date_id > 0 AND nvl(inc.customer_summary.first_awarded,0) < curr.customer_summary.dim_first_awarded_date_id and nvl(inc.customer_summary.first_awarded,0) != 0 then nvl(inc.customer_summary.first_awarded, -10003) else curr.customer_summary.dim_first_awarded_date_id end;inc.customer_summary.first_awarded := min(case when inc.points.dim_points_event_type_id = 1 then inc.points.dim_event_date_id else NULL end);','INC_REDUCE',0,0,1,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_first_awarded_date_id_-1000','customer_summary_-1000_dim_first_awarded_date_id','customer_summary_-1000'),
(885,6,'','NON_INC_REDUCE',0,0,0,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_second_last_bill_date_id_-1000','customer_summary_-1000_dim_second_last_bill_date_id','customer_summary_-1000'),
(886,6,'curr.customer_summary.dim_voucher_redemption_status_id := case when sum(case when curr.coupons.dim_coupon_event_type_id = 2 then 1 else 0 end) > 0 then 2 else 1 end;','NON_INC_REDUCE',0,0,1,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_voucher_redemption_status_id_-1000','customer_summary_-1000_dim_voucher_redemption_status_id','customer_summary_-1000'),
(887,6,'curr.customer_summary.dim_points_redemption_status_id := case when sum(case when curr.points.dim_points_event_type_id = 2 and curr.points.dim_deduction_type_id = 4 then 1 else 0 end) > 0 then 2 else 1 end;','NON_INC_REDUCE',0,0,1,-1000,'2018-07-06 01:54:55','2018-07-06 01:54:55','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_points_redemption_status_id_-1000','customer_summary_-1000_dim_points_redemption_status_id','customer_summary_-1000'),
(913,45,'curr.card_status_log_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.card_status_log_fact.auto_update_card_status/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 10:40:50','card_status_log_fact_-1897__dim_latest_updated_date_id_-1897','-1000_dim_latest_updated_date_id','card_status_log_fact_-1897'),
(913,1,'curr.bill_lineitems.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.bill_lineitems.auto_update_time_bill, curr.bill_lineitems.auto_update_time_bill_extended_fields, curr.bill_lineitems.auto_update_time_combo_details, curr.bill_lineitems.auto_update_time_lineitem, curr.bill_lineitems.auto_update_time_lineitem_extended_fields, curr.bill_lineitems.auto_update_time_shipping)/1000)), \'-\', \'\') as bigint );','MAP',0,-1,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','bill_lineitems_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','bill_lineitems_-1000'),
(913,2,'curr.return_bill_lineitem.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.return_bill_lineitem.auto_update_time_returned_bill, curr.return_bill_lineitem.auto_update_time_returned_lineitem)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','return_bill_lineitem_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','return_bill_lineitem_-1000'),
(913,3,'curr.bill_dump_bill_lineitems.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.bill_dump_bill_lineitems.auto_update_time_bill_dump_bill, curr.bill_dump_bill_lineitems.auto_update_time_bill_dump_lineitem)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','bill_dump_bill_lineitems_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','bill_dump_bill_lineitems_-1000'),
(913,5,'curr.points.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.points.auto_update_time_pd, curr.points.auto_update_time_pa, curr.points.auto_update_time_pacp, curr.points.auto_update_time_pal, curr.points.auto_update_time_pabp, curr.points.auto_update_time_palp)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','points_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','points_-1000'),
(913,6,'curr.customer_summary.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.customer_summary.auto_update_time_loyalty, curr.customer_summary.auto_update_time_cps, curr.customer_summary.auto_update_time_extnd)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','customer_summary_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','customer_summary_-1000'),
(913,7,'curr.nsadmin_messages.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.nsadmin_messages.auto_update_time_nsadmin/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','nsadmin_messages_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','nsadmin_messages_-1000'),
(913,8,'curr.contact_info.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.contact_info.auto_update_time_contact, curr.contact_info.auto_update_time_comm_details, curr.contact_info.auto_update_time_email_stats, curr.contact_info.auto_update_time_subs_stats)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','contact_info_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','contact_info_-1000'),
(913,9,'curr.points_expiry_reminder_info.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.points_expiry_reminder_info.auto_update_time_point_exp_reminder/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','points_expiry_reminder_info_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','points_expiry_reminder_info_-1000'),
(913,10,'curr.call_task_customer_status.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.call_task_customer_status.auto_update_time_task_status/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','call_task_customer_status_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','call_task_customer_status_-1000'),
(913,11,'curr.response_info.dim_latest_updated_date_id := curr.response_info.dim_event_date_id;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','response_info_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','response_info_-1000'),
(913,12,'curr.coupons.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.coupons.auto_update_time_coupons/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','coupons_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','coupons_-1000'),
(913,13,'curr.ffc_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.ffc_fact.auto_update_time_ffc_data_gc/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','ffc_fact_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','ffc_fact_-1000'),
(913,15,'curr.slab_change_log.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.slab_change_log.auto_update_time_slab_upgrade/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','slab_change_log_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','slab_change_log_-1000'),
(913,18,'curr.profile_users.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.profile_users.auto_update_time_profile_users/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','profile_users_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','profile_users_-1000'),
(913,20,'curr.wechat_click_stream.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.wechat_click_stream.auto_update_time_profile_v2_identifier, curr.wechat_click_stream.auto_update_time_event_feed)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','wechat_click_stream_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','wechat_click_stream_-1000'),
(913,21,'curr.wechat_qrscan_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.wechat_qrscan_fact.auto_update_time_profile_v2_identifier, curr.wechat_qrscan_fact.auto_update_time_event_feed)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','wechat_qrscan_fact_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','wechat_qrscan_fact_-1000'),
(913,22,'curr.keyword_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.keyword_fact.auto_update_time_profile_v2_identifier, curr.keyword_fact.auto_update_time_event_feed)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','keyword_fact_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','keyword_fact_-1000'),
(913,23,'curr.registration_event.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.registration_event.auto_update_time_entity_life_cycle/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','registration_event_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','registration_event_-1000'),
(913,24,'curr.payment_details_fact.dim_latest_updated_date_id := curr.payment_details_fact.dim_event_date_id;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','payment_details_fact_-994__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','payment_details_fact_-994'),
(913,25,'curr.issue_tracker_fact.dim_latest_updated_date_id := curr.issue_tracker_fact.dim_event_date_id;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','issue_tracker_fact_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','issue_tracker_fact_-1000'),
(913,26,'curr.custom_fields_data.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.custom_fields_data.auto_update_time_cf_data/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','custom_fields_data_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','custom_fields_data_-1000'),
(913,27,'curr.email_click_stats.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest(curr.email_click_stats.auto_update_time_link_redirection, curr.email_click_stats.auto_update_time_link_redirection_stats)/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','email_click_stats_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','email_click_stats_-1000'),
(913,28,'curr.customer_merge_log.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.customer_merge_log.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:50','customer_merge_log_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','customer_merge_log_-1000'),
(913,29,'curr.milestone_activity_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.milestone_activity_fact.auto_update_time_activity_context/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-11-27 13:10:42','2018-11-27 13:10:42','2021-11-30 10:40:50','milestone_activity_fact_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','milestone_activity_fact_-1000'),
(913,30,'curr.leads_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.leads_fact.auto_update_time_lead/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2019-01-17 21:56:47','2019-01-17 21:56:47','2021-11-30 10:40:50','leads_fact_-590__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','leads_fact_-590'),
(913,31,'curr.lead_events_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.lead_events_fact.auto_update_time_lead_event/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2018-09-27 01:10:35','2018-09-27 01:10:35','2021-11-30 10:40:50','lead_events_fact_-590__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','lead_events_fact_-590'),
(913,32,'curr.customer_notes.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.customer_notes.auto_update_time_customer_note/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2019-02-18 01:09:29','2019-02-18 01:09:29','2021-11-30 10:40:50','customer_notes_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','customer_notes_-1000'),
(913,33,'curr.communication_credit_logs.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.communication_credit_logs.auto_update_time_credits_log/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,NULL,'2019-04-04 07:50:59','2021-11-30 10:40:50','communication_credit_logs_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','communication_credit_logs_-1000'),
(913,34,'curr.referrals.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.referrals.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,NULL,'2019-04-12 02:08:38','2021-11-30 10:40:50','referrals_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','referrals_-1000'),
(913,35,'curr.referrers.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.referrers.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,NULL,'2019-04-12 02:09:19','2021-11-30 10:40:50','referrers_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','referrers_-1000'),
(913,36,'curr.invitations_sent.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.invitations_sent.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,NULL,'2019-04-12 02:09:56','2021-11-30 10:40:50','invitations_sent_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','invitations_sent_-1000'),
(913,41,'curr.points_redemption_summary.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.points_redemption_summary.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-1000,'2020-07-05 23:11:50','2020-07-05 23:11:50','2021-11-30 10:40:50','points_redemption_summary_-1000__dim_latest_updated_date_id_-1000','-1000_dim_latest_updated_date_id','points_redemption_summary_-1000'),
(913,37,'curr.cvp_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.cvp_fact.auto_update_time_cvp_data_gc/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-800,'2019-09-06 03:02:14','2019-09-06 03:02:14','2021-11-30 10:40:50','cvp_fact_-800__dim_latest_updated_date_id_-800','-1000_dim_latest_updated_date_id','cvp_fact_-800'),
(913,38,'curr.credit_ledger.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.credit_ledger.auto_update_time_credit_event/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-578,'2020-04-30 19:39:50','2020-04-30 19:39:50','2021-11-30 10:40:50','credit_ledger_-578__dim_latest_updated_date_id_-578','-1000_dim_latest_updated_date_id','credit_ledger_-578'),
(913,40,'curr.customer_points_summary.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.customer_points_summary.auto_update_time_ce/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-575,'2020-06-25 10:33:57','2020-06-25 10:33:57','2021-11-30 10:40:50','customer_points_summary_-575__dim_latest_updated_date_id_-575','-1000_dim_latest_updated_date_id','customer_points_summary_-575'),
(913,41,'curr.points_redemption_summary.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.points_redemption_summary.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,0,-575,'2020-07-05 23:11:50','2020-07-05 23:11:50','2021-11-30 10:40:50','points_redemption_summary_-1000__dim_latest_updated_date_id_-575','-1000_dim_latest_updated_date_id','points_redemption_summary_-1000'),
(913,41,'curr.points_redemption_summary.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.points_redemption_summary.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-571,'2020-07-05 23:11:50','2020-07-05 23:11:50','2021-11-30 10:40:50','points_redemption_summary_-1000__dim_latest_updated_date_id_-571','-1000_dim_latest_updated_date_id','points_redemption_summary_-1000'),
(913,42,'curr.subscription_config.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.subscription_config.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-563,'2020-12-09 23:11:50','2020-12-09 23:11:50','2021-11-30 10:40:50','subscription_config_-563__dim_latest_updated_date_id_-563','-1000_dim_latest_updated_date_id','subscription_config_-563'),
(913,43,'curr.subscription_status_change_log.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.subscription_status_change_log.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-563,'2020-12-09 23:11:50','2020-12-09 23:11:50','2021-11-30 10:40:50','subscription_status_change_log_-563__dim_latest_updated_date_id_-563','-1000_dim_latest_updated_date_id','subscription_status_change_log_-563'),
(913,44,'curr.subscription_status_change_fact.dim_latest_updated_date_id := curr.subscription_status_change_fact.dim_event_date_id;','MAP',0,0,1,-563,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 10:40:50','subscription_status_change_fact_-563__dim_latest_updated_date_id_-563','-1000_dim_latest_updated_date_id','subscription_status_change_fact_-563'),
(913,48,'curr.goodwill_requests.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest (curr.goodwill_requests.request_auto_update_time, curr.goodwill_requests.gr_auto_update_time, curr.goodwill_requests.gpl_auto_update_time) /1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-562,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 10:40:50','goodwill_requests_-562__dim_latest_updated_date_id_-562','-1000_dim_latest_updated_date_id','goodwill_requests_-562'),
(913,49,'curr.partner_program_enrollment.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.partner_program_enrollment.auto_update_time_pp_enrollment /1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:50','partner_program_enrollment_-562__dim_latest_updated_date_id_-562','-1000_dim_latest_updated_date_id','partner_program_enrollment_-562'),
(913,50,'curr.partner_program_slab_history.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.partner_program_slab_history.auto_update_time_pp_slab_history /1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:50','partner_program_slab_history_-562__dim_latest_updated_date_id_-562','-1000_dim_latest_updated_date_id','partner_program_slab_history_-562'),
(913,51,'curr.supplementary_partner_program_enrollment.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.supplementary_partner_program_enrollment.auto_update_time_supp_pp_enrollment/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:50','supplementary_partner_program_enrollment_-562__dim_latest_updated_date_id_-562','-1000_dim_latest_updated_date_id','supplementary_partner_program_enrollment_-562'),
(913,52,'curr.supplementary_membership_history.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.supplementary_membership_history.auto_update_time_supp_pp_membership_history/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:50','supplementary_membership_history_-562__dim_latest_updated_date_id_-562','-1000_dim_latest_updated_date_id','supplementary_membership_history_-562'),
(913,53,'curr.loyalty_benefits.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(greatest (curr.loyalty_benefits.auto_update_time_customer_benefit_tracking_log, curr.loyalty_benefits.auto_update_time_customer_benefit_tracking) /1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-562,'2020-10-04 11:48:00','2020-10-04 11:48:00','2021-11-30 10:40:50','loyalty_benefits_-562__dim_latest_updated_date_id_-562','-1000_dim_latest_updated_date_id','loyalty_benefits_-562'),
(913,46,'curr.promotion_redemptions_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.promotion_redemptions_fact.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 10:40:50','promotion_redemptions_fact_-552__dim_latest_updated_date_id_-552','-1000_dim_latest_updated_date_id','promotion_redemptions_fact_-552'),
(913,47,'curr.promotion_activities_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.promotion_activities_fact.auto_update_time/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 10:40:50','promotion_activities_fact_-552__dim_latest_updated_date_id_-552','-1000_dim_latest_updated_date_id','promotion_activities_fact_-552'),
(913,45,'curr.card_status_log_fact.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.card_status_log_fact.auto_update_card_status/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 10:40:50','card_status_log_fact_-1897__dim_latest_updated_date_id_1897','-1000_dim_latest_updated_date_id','card_status_log_fact_-1897'),
(914,45,'curr.card_status_log_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.card_status_log_fact.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.card_status_log_fact.auto_update_time/1000))+1;','MAP',0,0,1,-1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 10:40:51','card_status_log_fact_-1897__dim_latest_updated_time_id_-1897','-1000_dim_latest_updated_time_id','card_status_log_fact_-1897'),
(914,1,'curr.bill_lineitems.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.bill_lineitems.auto_update_time_bill, curr.bill_lineitems.auto_update_time_bill_extended_fields, curr.bill_lineitems.auto_update_time_combo_details, curr.bill_lineitems.auto_update_time_lineitem, curr.bill_lineitems.auto_update_time_lineitem_extended_fields, curr.bill_lineitems.auto_update_time_shipping)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.bill_lineitems.auto_update_time_bill, curr.bill_lineitems.auto_update_time_bill_extended_fields, curr.bill_lineitems.auto_update_time_combo_details, curr.bill_lineitems.auto_update_time_lineitem, curr.bill_lineitems.auto_update_time_lineitem_extended_fields, curr.bill_lineitems.auto_update_time_shipping)/1000)) + 1;','MAP',0,-1,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','bill_lineitems_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','bill_lineitems_-1000'),
(914,2,'curr.return_bill_lineitem.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.return_bill_lineitem.auto_update_time_returned_bill, curr.return_bill_lineitem.auto_update_time_returned_lineitem)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.return_bill_lineitem.auto_update_time_returned_bill, curr.return_bill_lineitem.auto_update_time_returned_lineitem)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','return_bill_lineitem_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','return_bill_lineitem_-1000'),
(914,3,'curr.bill_dump_bill_lineitems.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.bill_dump_bill_lineitems.auto_update_time_bill_dump_bill, curr.bill_dump_bill_lineitems.auto_update_time_bill_dump_lineitem)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.bill_dump_bill_lineitems.auto_update_time_bill_dump_bill, curr.bill_dump_bill_lineitems.auto_update_time_bill_dump_lineitem)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','bill_dump_bill_lineitems_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','bill_dump_bill_lineitems_-1000'),
(914,5,'curr.points.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.points.auto_update_time_pd, curr.points.auto_update_time_pa, curr.points.auto_update_time_pacp, curr.points.auto_update_time_pal, curr.points.auto_update_time_pabp, curr.points.auto_update_time_palp)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.points.auto_update_time_pd, curr.points.auto_update_time_pa, curr.points.auto_update_time_pacp, curr.points.auto_update_time_pal, curr.points.auto_update_time_pabp, curr.points.auto_update_time_palp)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','points_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','points_-1000'),
(914,6,'curr.customer_summary.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.customer_summary.auto_update_time_loyalty, curr.customer_summary.auto_update_time_cps, curr.customer_summary.auto_update_time_extnd)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.customer_summary.auto_update_time_loyalty, curr.customer_summary.auto_update_time_cps, curr.customer_summary.auto_update_time_extnd)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','customer_summary_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','customer_summary_-1000'),
(914,7,'curr.nsadmin_messages.dim_latest_updated_time_id := HOUR(from_unixtime(curr.nsadmin_messages.auto_update_time_nsadmin/1000)) * 60 + MINUTE(from_unixtime(curr.nsadmin_messages.auto_update_time_nsadmin/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','nsadmin_messages_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','nsadmin_messages_-1000'),
(914,8,'curr.contact_info.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.contact_info.auto_update_time_contact, curr.contact_info.auto_update_time_comm_details, curr.contact_info.auto_update_time_email_stats, curr.contact_info.auto_update_time_subs_stats)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.contact_info.auto_update_time_contact, curr.contact_info.auto_update_time_comm_details, curr.contact_info.auto_update_time_email_stats, curr.contact_info.auto_update_time_subs_stats)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','contact_info_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','contact_info_-1000'),
(914,9,'curr.points_expiry_reminder_info.dim_latest_updated_time_id := HOUR(from_unixtime(curr.points_expiry_reminder_info.auto_update_time_point_exp_reminder/1000)) * 60 + MINUTE(from_unixtime(curr.points_expiry_reminder_info.auto_update_time_point_exp_reminder/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','points_expiry_reminder_info_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','points_expiry_reminder_info_-1000'),
(914,10,'curr.call_task_customer_status.dim_latest_updated_time_id := HOUR(from_unixtime(curr.call_task_customer_status.auto_update_time_task_status/1000)) * 60 + MINUTE(from_unixtime(curr.call_task_customer_status.auto_update_time_task_status/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','call_task_customer_status_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','call_task_customer_status_-1000'),
(914,11,'curr.response_info.dim_latest_updated_time_id := curr.response_info.dim_event_time_id;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','response_info_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','response_info_-1000'),
(914,12,'curr.coupons.dim_latest_updated_time_id := HOUR(from_unixtime(curr.coupons.auto_update_time_coupons/1000)) * 60 + MINUTE(from_unixtime(curr.coupons.auto_update_time_coupons/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','coupons_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','coupons_-1000'),
(914,13,'curr.ffc_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.ffc_fact.auto_update_time_ffc_data_gc/1000)) * 60 + MINUTE(from_unixtime(curr.ffc_fact.auto_update_time_ffc_data_gc/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','ffc_fact_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','ffc_fact_-1000'),
(914,15,'curr.slab_change_log.dim_latest_updated_time_id := HOUR(from_unixtime(curr.slab_change_log.auto_update_time_slab_upgrade/1000)) * 60 + MINUTE(from_unixtime(curr.slab_change_log.auto_update_time_slab_upgrade/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','slab_change_log_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','slab_change_log_-1000'),
(914,18,'curr.profile_users.dim_latest_updated_time_id := HOUR(from_unixtime(curr.profile_users.auto_update_time_profile_users/1000)) * 60 + MINUTE(from_unixtime(curr.profile_users.auto_update_time_profile_users/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','profile_users_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','profile_users_-1000'),
(914,20,'curr.wechat_click_stream.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.wechat_click_stream.auto_update_time_profile_v2_identifier, curr.wechat_click_stream.auto_update_time_event_feed)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.wechat_click_stream.auto_update_time_profile_v2_identifier, curr.wechat_click_stream.auto_update_time_event_feed)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','wechat_click_stream_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','wechat_click_stream_-1000'),
(914,21,'curr.wechat_qrscan_fact.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.wechat_qrscan_fact.auto_update_time_profile_v2_identifier, curr.wechat_qrscan_fact.auto_update_time_event_feed)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.wechat_qrscan_fact.auto_update_time_profile_v2_identifier, curr.wechat_qrscan_fact.auto_update_time_event_feed)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','wechat_qrscan_fact_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','wechat_qrscan_fact_-1000'),
(914,22,'curr.keyword_fact.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.keyword_fact.auto_update_time_profile_v2_identifier, curr.keyword_fact.auto_update_time_event_feed)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.keyword_fact.auto_update_time_profile_v2_identifier, curr.keyword_fact.auto_update_time_event_feed)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','keyword_fact_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','keyword_fact_-1000'),
(914,23,'curr.registration_event.dim_latest_updated_time_id := HOUR(from_unixtime(curr.registration_event.auto_update_time_entity_life_cycle/1000)) * 60 + MINUTE(from_unixtime(curr.registration_event.auto_update_time_entity_life_cycle/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','registration_event_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','registration_event_-1000'),
(914,24,'curr.payment_details_fact.dim_latest_updated_time_id := curr.payment_details_fact.dim_event_time_id;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','payment_details_fact_-994__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','payment_details_fact_-994'),
(914,25,'curr.issue_tracker_fact.dim_latest_updated_time_id := curr.issue_tracker_fact.dim_event_time_id;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','issue_tracker_fact_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','issue_tracker_fact_-1000'),
(914,26,'curr.custom_fields_data.dim_latest_updated_time_id := HOUR(from_unixtime(curr.custom_fields_data.auto_update_time_cf_data/1000)) * 60 + MINUTE(from_unixtime(curr.custom_fields_data.auto_update_time_cf_data/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','custom_fields_data_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','custom_fields_data_-1000'),
(914,27,'curr.email_click_stats.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.email_click_stats.auto_update_time_link_redirection, curr.email_click_stats.auto_update_time_link_redirection_stats)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.email_click_stats.auto_update_time_link_redirection, curr.email_click_stats.auto_update_time_link_redirection_stats)/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','email_click_stats_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','email_click_stats_-1000'),
(914,28,'curr.customer_merge_log.dim_latest_updated_time_id := HOUR(from_unixtime(curr.customer_merge_log.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.customer_merge_log.auto_update_time/1000)) + 1;','MAP',0,0,1,-1000,'2018-10-05 01:43:03','2018-10-05 01:43:03','2021-11-30 10:40:51','customer_merge_log_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','customer_merge_log_-1000'),
(914,29,'curr.milestone_activity_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.milestone_activity_fact.auto_update_time_activity_context/1000)) * 60 + MINUTE(from_unixtime(curr.milestone_activity_fact.auto_update_time_activity_context/1000));','MAP',0,0,1,-1000,'2018-09-27 06:40:35','2018-09-27 06:40:35','2021-11-30 10:40:51','milestone_activity_fact_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','milestone_activity_fact_-1000'),
(914,30,'curr.leads_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.leads_fact.auto_update_time_lead/1000)) * 60 + MINUTE(from_unixtime(curr.leads_fact.auto_update_time_lead/1000));','MAP',0,0,1,-1000,'2019-01-17 22:01:02','2019-01-17 22:01:02','2021-11-30 10:40:51','leads_fact_-590__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','leads_fact_-590'),
(914,31,'curr.lead_events_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.lead_events_fact.auto_update_time_lead_event/1000)) * 60 + MINUTE(from_unixtime(curr.lead_events_fact.auto_update_time_lead_event/1000));','MAP',0,0,1,-1000,'2019-01-17 22:01:02','2019-01-17 22:01:02','2021-11-30 10:40:51','lead_events_fact_-590__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','lead_events_fact_-590'),
(914,32,'curr.customer_notes.dim_latest_updated_time_id := HOUR(from_unixtime(curr.customer_notes.auto_update_time_customer_note/1000)) * 60 + MINUTE(from_unixtime(curr.customer_notes.auto_update_time_customer_note/1000))+1;','MAP',0,0,1,-1000,'2019-02-18 01:09:50','2019-02-18 01:09:50','2021-11-30 10:40:51','customer_notes_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','customer_notes_-1000'),
(914,33,'curr.communication_credit_logs.dim_latest_updated_time_id := HOUR(from_unixtime(curr.communication_credit_logs.auto_update_time_credits_log/1000)) * 60 + MINUTE(from_unixtime(curr.communication_credit_logs.auto_update_time_credits_log/1000))+1;','MAP',0,0,1,-1000,NULL,'2019-04-04 07:50:59','2021-11-30 10:40:51','communication_credit_logs_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','communication_credit_logs_-1000'),
(914,34,'curr.referrals.dim_latest_updated_time_id := HOUR(from_unixtime(curr.referrals.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.referrals.auto_update_time/1000))+1;','MAP',0,0,1,-1000,NULL,'2019-04-12 02:08:38','2021-11-30 10:40:51','referrals_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','referrals_-1000'),
(914,35,'curr.referrers.dim_latest_updated_time_id := HOUR(from_unixtime(curr.referrers.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.referrers.auto_update_time/1000))+1;','MAP',0,0,1,-1000,NULL,'2019-04-12 02:09:19','2021-11-30 10:40:51','referrers_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','referrers_-1000'),
(914,36,'curr.invitations_sent.dim_latest_updated_time_id := HOUR(from_unixtime(curr.invitations_sent.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.invitations_sent.auto_update_time/1000))+1;','MAP',0,0,1,-1000,NULL,'2019-04-12 02:09:56','2021-11-30 10:40:51','invitations_sent_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','invitations_sent_-1000'),
(914,41,'curr.points_redemption_summary.dim_latest_updated_time_id := HOUR(from_unixtime(curr.points_redemption_summary.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.points_redemption_summary.auto_update_time/1000))+1;','MAP',0,0,1,-1000,'2020-07-05 23:11:50','2020-07-05 23:11:50','2021-11-30 10:40:51','points_redemption_summary_-1000__dim_latest_updated_time_id_-1000','-1000_dim_latest_updated_time_id','points_redemption_summary_-1000'),
(914,37,'curr.cvp_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.cvp_fact.auto_update_time_cvp_data_gc/1000)) * 60 + MINUTE(from_unixtime(curr.cvp_fact.auto_update_time_cvp_data_gc/1000)) + 1;','MAP',0,0,1,-800,'2019-09-06 03:02:14','2019-09-06 03:02:14','2021-11-30 10:40:51','cvp_fact_-800__dim_latest_updated_time_id_-800','-1000_dim_latest_updated_time_id','cvp_fact_-800'),
(914,38,'curr.credit_ledger.dim_latest_updated_time_id := HOUR(from_unixtime(curr.credit_ledger.auto_update_time_credit_event/1000)) * 60 + MINUTE(from_unixtime(curr.credit_ledger.auto_update_time_credit_event/1000))+1;','MAP',0,0,1,-578,'2020-04-30 19:39:50','2020-04-30 19:39:50','2021-11-30 10:40:51','credit_ledger_-578__dim_latest_updated_time_id_-578','-1000_dim_latest_updated_time_id','credit_ledger_-578'),
(914,40,'curr.customer_points_summary.dim_latest_updated_time_id := HOUR(from_unixtime(curr.customer_points_summary.auto_update_time_ce/1000)) * 60 + MINUTE(from_unixtime(curr.customer_points_summary.auto_update_time_ce/1000))+1;','MAP',0,0,1,-575,'2020-06-25 10:33:57','2020-06-25 10:33:57','2021-11-30 10:40:51','customer_points_summary_-575__dim_latest_updated_time_id_-575','-1000_dim_latest_updated_time_id','customer_points_summary_-575'),
(914,41,'curr.points_redemption_summary.dim_latest_updated_time_id := HOUR(from_unixtime(curr.points_redemption_summary.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.points_redemption_summary.auto_update_time/1000))+1;','MAP',0,0,0,-575,'2020-07-05 23:11:50','2020-07-05 23:11:50','2021-11-30 10:40:51','points_redemption_summary_-1000__dim_latest_updated_time_id_-575','-1000_dim_latest_updated_time_id','points_redemption_summary_-1000'),
(914,41,'curr.points_redemption_summary.dim_latest_updated_time_id := HOUR(from_unixtime(curr.points_redemption_summary.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.points_redemption_summary.auto_update_time/1000))+1;','MAP',0,0,1,-571,'2020-07-05 23:11:50','2020-07-05 23:11:50','2021-11-30 10:40:51','points_redemption_summary_-1000__dim_latest_updated_time_id_-571','-1000_dim_latest_updated_time_id','points_redemption_summary_-1000'),
(914,42,'curr.subscription_config.dim_latest_updated_time_id := HOUR(from_unixtime(curr.subscription_config.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.subscription_config.auto_update_time/1000))+1;','MAP',0,0,1,-563,'2020-12-09 23:11:50','2020-12-09 23:11:50','2021-11-30 10:40:51','subscription_config_-563__dim_latest_updated_time_id_-563','-1000_dim_latest_updated_time_id','subscription_config_-563'),
(914,43,'curr.subscription_status_change_log.dim_latest_updated_time_id := HOUR(from_unixtime(curr.subscription_status_change_log.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.subscription_status_change_log.auto_update_time/1000))+1;','MAP',0,0,1,-563,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 10:40:51','subscription_status_change_log_-563__dim_latest_updated_time_id_-563','-1000_dim_latest_updated_time_id','subscription_status_change_log_-563'),
(914,44,'curr.subscription_status_change_fact.dim_latest_updated_time_id := curr.subscription_status_change_fact.dim_event_time_id;','MAP',0,0,1,-563,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 10:40:51','subscription_status_change_fact_-563__dim_latest_updated_time_id_-563','-1000_dim_latest_updated_time_id','subscription_status_change_fact_-563'),
(914,48,'curr.goodwill_requests.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.goodwill_requests.request_auto_update_time, curr.goodwill_requests.gr_auto_update_time, curr.goodwill_requests.gpl_auto_update_time)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.goodwill_requests.request_auto_update_time, curr.goodwill_requests.gr_auto_update_time, curr.goodwill_requests.gpl_auto_update_time)/1000))+1;','MAP',0,0,1,-562,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 10:40:51','goodwill_requests_-562__dim_latest_updated_time_id_-562','-1000_dim_latest_updated_time_id','goodwill_requests_-562'),
(914,49,'curr.partner_program_enrollment.dim_latest_updated_time_id := HOUR(from_unixtime(curr.partner_program_enrollment.auto_update_time_pp_enrollment/1000)) * 60 + MINUTE(from_unixtime(curr.partner_program_enrollment.auto_update_time_pp_enrollment/1000))+1;','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:51','partner_program_enrollment_-562__dim_latest_updated_time_id_-562','-1000_dim_latest_updated_time_id','partner_program_enrollment_-562'),
(914,50,'curr.partner_program_slab_history.dim_latest_updated_time_id := HOUR(from_unixtime(curr.partner_program_slab_history.auto_update_time_pp_slab_history/1000)) * 60 + MINUTE(from_unixtime(curr.partner_program_slab_history.auto_update_time_pp_slab_history/1000))+1;','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:51','partner_program_slab_history_-562__dim_latest_updated_time_id_-562','-1000_dim_latest_updated_time_id','partner_program_slab_history_-562'),
(914,51,'curr.supplementary_partner_program_enrollment.dim_latest_updated_time_id := HOUR(from_unixtime(curr.supplementary_partner_program_enrollment.auto_update_time_supp_pp_enrollment/1000)) * 60 + MINUTE(from_unixtime(curr.supplementary_partner_program_enrollment.auto_update_time_supp_pp_enrollment/1000))+1;','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:51','supplementary_partner_program_enrollment_-562__dim_latest_updated_time_id_-562','-1000_dim_latest_updated_time_id','supplementary_partner_program_enrollment_-562'),
(914,52,'curr.supplementary_membership_history.dim_latest_updated_time_id := HOUR(from_unixtime(curr.supplementary_membership_history.auto_update_time_supp_pp_membership_history/1000)) * 60 + MINUTE(from_unixtime(curr.supplementary_membership_history.auto_update_time_supp_pp_membership_history/1000))+1;','MAP',0,0,1,-562,'2020-10-04 00:48:00','2020-10-04 00:48:00','2021-11-30 10:40:51','supplementary_membership_history_-562__dim_latest_updated_time_id_-562','-1000_dim_latest_updated_time_id','supplementary_membership_history_-562'),
(914,53,'curr.loyalty_benefits.dim_latest_updated_time_id := HOUR(from_unixtime(greatest(curr.loyalty_benefits.auto_update_time_customer_benefit_tracking_log, curr.loyalty_benefits.auto_update_time_customer_benefit_tracking)/1000)) * 60 + MINUTE(from_unixtime(greatest(curr.loyalty_benefits.auto_update_time_customer_benefit_tracking_log, curr.loyalty_benefits.auto_update_time_customer_benefit_tracking)/1000))+1;','MAP',0,0,1,-562,'2020-10-04 11:48:00','2020-10-04 11:48:00','2021-11-30 10:40:51','loyalty_benefits_-562__dim_latest_updated_time_id_-562','-1000_dim_latest_updated_time_id','loyalty_benefits_-562'),
(914,46,'curr.promotion_redemptions_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.promotion_redemptions_fact.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.promotion_redemptions_fact.auto_update_time/1000)) + 1;','MAP',0,0,1,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 10:40:51','promotion_redemptions_fact_-552__dim_latest_updated_time_id_-552','-1000_dim_latest_updated_time_id','promotion_redemptions_fact_-552'),
(914,47,'curr.promotion_activities_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.promotion_activities_fact.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.promotion_activities_fact.auto_update_time/1000)) + 1;','MAP',0,0,1,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 10:40:51','promotion_activities_fact_-552__dim_latest_updated_time_id_-552','-1000_dim_latest_updated_time_id','promotion_activities_fact_-552'),
(914,45,'curr.card_status_log_fact.dim_latest_updated_time_id := HOUR(from_unixtime(curr.card_status_log_fact.auto_update_time/1000)) * 60 + MINUTE(from_unixtime(curr.card_status_log_fact.auto_update_time/1000))+1;','MAP',0,0,1,1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 10:40:51','card_status_log_fact_-1897__dim_latest_updated_time_id_1897','-1000_dim_latest_updated_time_id','card_status_log_fact_-1897'),
(916,6,'curr.customer_summary.max_bill_hour_count_in_day := case when curr.customer_summary.max_bill_hour_count_in_day > nvl(inc.customer_summary.max_bill_count_hour,0) then curr.customer_summary.max_bill_hour_count_in_day else nvl(inc.customer_summary.max_bill_count_hour,0) end;inc.customer_summary.max_bill_count_hour := max(bill_counthour);{insert=count(distinct case when curr.bill_lineitems.dim_bill_outlier_status_id = 1 then curr.bill_lineitems.bill_id else NULL end) AS bill_counthour:::update=count(null) AS bill_counthour:::group_by=curr.bill_lineitems.dim_membership_id,curr.bill_lineitems.dim_event_user_id,curr.bill_lineitems.dim_event_date_id,dimension.time.hour_of_day};','INC_REDUCE',1,0,1,-1000,'2018-10-05 01:43:16','2018-10-05 01:43:16','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_max_bill_hour_count_in_day_-1000','customer_summary_-1000_max_bill_hour_count_in_day','customer_summary_-1000'),
(918,5,'curr.points.bill_number := nvl(first(curr.bill_lineitems.bill_number), \'\');','NON_INC_REDUCE',0,0,1,-1000,'2018-11-02 01:03:43','2018-11-02 01:03:43','2021-11-30 09:22:28','points_-1000_points_-1000_bill_number_-1000','points_-1000_bill_number','points_-1000'),
(918,5,'curr.points.bill_number := curr.points.bill_id;','MAP',0,0,1,-879,NULL,'2020-05-04 19:43:28','2021-11-30 09:22:28','points_-1000_points_-1000_bill_number_-879','points_-1000_bill_number','points_-1000'),
(926,29,'curr.milestone_activity_fact.dim_timeline_id := 10000000000*curr.milestone_activity_fact.dim_org_config_id + curr.milestone_activity_fact.timeline_id;','MAP',0,0,1,-1000,'2019-02-15 00:00:24','2019-02-15 00:00:24','2021-11-30 09:22:28','milestone_activity_fact_-1000_milestone_activity_fact_-1000_dim_timeline_id_-1000','milestone_activity_fact_-1000_dim_timeline_id','milestone_activity_fact_-1000'),
(927,29,'curr.milestone_activity_fact.dim_milestone_id := 10000000000*curr.milestone_activity_fact.dim_org_config_id + curr.milestone_activity_fact.milestone_id;','MAP',0,0,1,-1000,'2019-02-15 00:00:24','2019-02-15 00:00:24','2021-11-30 09:22:28','milestone_activity_fact_-1000_milestone_activity_fact_-1000_dim_milestone_id_-1000','milestone_activity_fact_-1000_dim_milestone_id','milestone_activity_fact_-1000'),
(930,29,'curr.milestone_activity_fact.dim_delivery_status_id := case when inc.milestone_activity_fact.delivery_status IS NULL AND  curr.milestone_activity_fact.dim_communication_type_id = 4 THEN -10003 WHEN  inc.milestone_activity_fact.delivery_status IS NULL AND  curr.milestone_activity_fact.dim_communication_type_id != 4 THEN -10001 else  inc.milestone_activity_fact.delivery_status end ; inc.milestone_activity_fact.delivery_status := first(curr.nsadmin_messages.dim_delivery_status_id); ','INC_REDUCE',0,0,1,-1000,'2019-02-15 00:00:24','2019-02-15 00:00:24','2021-11-30 09:22:28','milestone_activity_fact_-1000_milestone_activity_fact_-1000_dim_delivery_status_id_-1000','milestone_activity_fact_-1000_dim_delivery_status_id','milestone_activity_fact_-1000'),
(939,29,'curr.milestone_activity_fact.dim_phase_id := 10000000000*curr.milestone_activity_fact.dim_org_config_id + curr.milestone_activity_fact.phase_id;','MAP',0,0,1,-1000,'2019-02-15 00:00:24','2019-02-15 00:00:24','2021-11-30 09:22:28','milestone_activity_fact_-1000_milestone_activity_fact_-1000_dim_phase_id_-1000','milestone_activity_fact_-1000_dim_phase_id','milestone_activity_fact_-1000'),
(941,5,'curr.points.dim_category_id := inc.points.awarded_category_id;inc.points.awarded_category_id := first(case when  curr.points.dim_points_event_type_id = 1 then curr.points.dim_old_category_id else null end, true);','INC_REDUCE',0,0,1,-1000,'2018-12-21 00:28:46','2018-12-21 00:28:46','2021-11-30 09:22:28','points_-1000_points_-1000_dim_category_id_-1000','points_-1000_dim_category_id','points_-1000'),
(942,1,'curr.bill_lineitems.allocated_points := sum(case when curr.points.dim_points_event_type_id = 1     AND curr.points.bill_id > 0 AND dimension.points_category.redeemtion_type = \'REDEEMABLE\' then curr.points.allocated_points else 0 end);','NON_INC_REDUCE',0,-1,1,-1000,'2019-02-15 00:02:36','2019-02-15 00:02:36','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_allocated_points_-1000','bill_lineitems_-1000_allocated_points','bill_lineitems_-1000'),
(995,5,'curr.points.dim_awarded_expiry_date_id := inc.points.awarded_expiry_date;inc.points.awarded_expiry_date := first(case when  curr.points.dim_points_event_type_id = 1 then curr.points.dim_expiry_date_id else null end, true);','INC_REDUCE',0,0,1,-1000,'2018-12-09 00:58:15','2018-12-09 00:58:15','2021-11-30 09:22:28','points_-1000_points_-1000_dim_awarded_expiry_date_id_-1000','points_-1000_dim_awarded_expiry_date_id','points_-1000'),
(1049,33,'curr.communication_credit_logs.dim_credit_type_id := case when curr.communication_credit_logs.src_credit_value > 0 then 1 else 2 end;','MAP',0,0,1,-1000,'2019-04-03 18:30:00','2019-04-03 18:30:00','2021-11-30 09:22:28','communication_credit_logs_-1000_communication_credit_logs_-1000_dim_credit_type_id_-1000','communication_credit_logs_-1000_dim_credit_type_id','communication_credit_logs_-1000'),
(1053,33,'curr.communication_credit_logs.abs_credit_value := abs(curr.communication_credit_logs.src_credit_value);','MAP',0,0,1,-1000,'2019-04-03 18:30:00','2019-04-03 18:30:00','2021-11-30 09:22:28','communication_credit_logs_-1000_communication_credit_logs_-1000_abs_credit_value_-1000','communication_credit_logs_-1000_abs_credit_value','communication_credit_logs_-1000'),
(1310,6,'curr.customer_summary.dim_joined_date_id := min(curr.profile_users.dim_event_date_id);','NON_INC_REDUCE',0,0,1,-1000,'2019-08-06 21:26:54','2019-08-06 21:26:54','2021-11-30 09:22:28','customer_summary_-1000_customer_summary_-1000_dim_joined_date_id_-1000','customer_summary_-1000_dim_joined_date_id','customer_summary_-1000'),
(1321,37,'curr.cvp_fact.dim_event_date_id := case when dimension.zone_tills.timezone IN (\'NOT-CAPTURED\',\'INVALID\',\'NOT-APPLICABLE\') then curr.cvp_fact.dim_device_date_id else 10000*YEAR(from_utc_timestamp(from_unixtime(curr.cvp_fact.event_timestamp / 1000), dimension.zone_tills.timezone)) +100*MONTH(from_utc_timestamp(from_unixtime(curr.cvp_fact.event_timestamp / 1000), dimension.zone_tills.timezone)) + DAY(from_utc_timestamp(from_unixtime(curr.cvp_fact.event_timestamp / 1000), dimension.zone_tills.timezone)) end;','MAP',0,0,1,-800,'2019-09-06 03:02:14','2019-09-06 03:02:14','2021-11-30 09:22:28','cvp_fact_-800_cvp_fact_-800_dim_event_date_id_-800','cvp_fact_-800_dim_event_date_id','cvp_fact_-800'),
(1322,37,'curr.cvp_fact.dim_event_time_id := case when dimension.zone_tills.timezone IN (\'NOT-CAPTURED\',\'INVALID\',\'NOT-APPLICABLE\') then curr.cvp_fact.dim_device_time_id else hour(from_utc_timestamp(from_unixtime(curr.cvp_fact.event_timestamp / 1000), dimension.zone_tills.timezone)) * 60 + minute(from_utc_timestamp(from_unixtime(curr.cvp_fact.event_timestamp / 1000), dimension.zone_tills.timezone)) end;','MAP',0,0,1,-800,'2019-09-06 03:02:14','2019-09-06 03:02:14','2021-11-30 09:22:28','cvp_fact_-800_cvp_fact_-800_dim_event_time_id_-800','cvp_fact_-800_dim_event_time_id','cvp_fact_-800'),
(1573,1,'curr.bill_lineitems.time_stamp := from_unixtime(greatest(curr.bill_lineitems.auto_update_time_bill, curr.bill_lineitems.auto_update_time_bill_extended_fields, curr.bill_lineitems.auto_update_time_combo_details, curr.bill_lineitems.auto_update_time_lineitem, curr.bill_lineitems.auto_update_time_lineitem_extended_fields, curr.bill_lineitems.auto_update_time_shipping)/1000);','MAP',0,0,1,-566,'2020-07-28 01:57:39','2020-07-28 01:57:39','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_time_stamp_-566','bill_lineitems_-1000_time_stamp','bill_lineitems_-1000'),
(1573,1,'curr.bill_lineitems.time_stamp := from_unixtime(greatest(curr.bill_lineitems.auto_update_time_bill, curr.bill_lineitems.auto_update_time_bill_extended_fields, curr.bill_lineitems.auto_update_time_combo_details, curr.bill_lineitems.auto_update_time_lineitem, curr.bill_lineitems.auto_update_time_lineitem_extended_fields, curr.bill_lineitems.auto_update_time_shipping)/1000);','MAP',0,0,1,50181,'2020-07-28 01:57:39','2020-07-28 01:57:39','2021-11-30 09:22:28','bill_lineitems_-1000_bill_lineitems_-1000_time_stamp_50181','bill_lineitems_-1000_time_stamp','bill_lineitems_-1000'),
(1574,5,'curr.points.dim_event_program_id := case when curr.points.dim_redemption_program_id IS null then curr.points.dim_awarded_program_id else curr.points.dim_redemption_program_id end;','MAP',0,0,0,-575,'2019-12-31 02:00:00','2020-07-13 12:21:24','2021-11-30 09:22:28','points_-1000_points_-1000_dim_event_program_id_-575','points_-1000_dim_event_program_id','points_-1000'),
(1574,5,'curr.points.dim_event_program_id := case when curr.points.dim_redemption_program_id IS null then curr.points.dim_awarded_program_id else curr.points.dim_redemption_program_id end;','MAP',0,0,1,-571,'2019-12-31 02:00:00','2020-07-13 12:21:24','2021-11-30 09:22:28','points_-1000_points_-1000_dim_event_program_id_-571','points_-1000_dim_event_program_id','points_-1000'),
(1620,44,'curr.subs_dim_optin_status_id_change_final.dim_optin_status_id := CASE WHEN curr.subscription_dim_optin_status_id_change_log.dim_optin_status_id IN (-10001, -10002, -10003) AND curr.subscription_config.dim_optin_status_id != -10001 THEN curr.subscription_config.dim_optin_status_id WHEN curr.subscription_dim_optin_status_id_change_log.dim_optin_status_id IN (-10001, -10002, -10003) AND curr.subscription_config.dim_optin_strategy_id = 2 THEN 4 WHEN curr.subscription_dim_optin_status_id_change_log.dim_optin_status_id IN (-10001, -10002, -10003) AND curr.subscription_config.dim_optin_strategy_id = 1 THEN 3 ELSE curr.subscription_dim_optin_status_id_change_log.dim_optin_status_id END;','MAP',0,0,1,-563,'2021-01-06 20:11:15','2021-01-06 20:11:15','2021-11-30 09:22:28','subscription_status_change_fact_-563_subscription_status_change_fact_-563_dim_optin_status_id_-563','subscription_status_change_fact_-563_dim_optin_status_id','subscription_status_change_fact_-563'),
(1630,12,'curr.coupons.dim_final_issual_zone_till_id := case when first(curr.coupons.dim_coupon_issual_type_id) = 2 then first(dimension.users.registered_till_id) else first(curr.coupons.dim_issual_zone_till_id) end;','NON_INC_REDUCE',0,0,1,-561,'2021-03-02 23:18:45','2021-03-02 23:18:45','2021-11-30 09:22:28','coupons_-1000_coupons_-1000_dim_final_issual_zone_till_id_-561','coupons_-1000_dim_final_issual_zone_till_id','coupons_-1000'),
(1633,45,'curr.card_status_log_fact.dim_card_series_id := dimension.card_used.series_id;','MAP',0,0,1,-1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 09:22:28','card_status_log_fact_-1897_card_status_log_fact_-1897_dim_card_series_id_-1897','card_status_log_fact_-1897_dim_card_series_id','card_status_log_fact_-1897'),
(1633,45,'curr.card_status_log_fact.dim_card_series_id := dimension.card_used.series_id;','MAP',0,0,1,1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 09:22:28','card_status_log_fact_-1897_card_status_log_fact_-1897_dim_card_series_id_1897','card_status_log_fact_-1897_dim_card_series_id','card_status_log_fact_-1897'),
(1638,45,'curr.card_status_log_fact.dim_event_user_id := dimension.card_used.user_id;','MAP',0,0,1,-1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 09:22:28','card_status_log_fact_-1897_card_status_log_fact_-1897_dim_event_user_id_-1897','card_status_log_fact_-1897_dim_event_user_id','card_status_log_fact_-1897'),
(1638,45,'curr.card_status_log_fact.dim_card_user_id := dimension.card_used.user_id;','MAP',0,0,1,1897,'2021-01-05 23:11:50','2021-01-05 23:11:50','2021-11-30 09:22:28','card_status_log_fact_-1897_card_status_log_fact_-1897_dim_event_user_id_1897','card_status_log_fact_-1897_dim_event_user_id','card_status_log_fact_-1897'),
(1657,47,'curr.promotion_activities_fact.dim_campaign_id := dimension.cart_promotion.campaign_id;','MAP',0,0,1,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 09:22:28','promotion_activities_fact_-552_promotion_activities_fact_-552_dim_campaign_id_-552','promotion_activities_fact_-552_dim_campaign_id','promotion_activities_fact_-552'),
(1670,46,'curr.promotion_redemptions_fact.dim_campaign_id := dimension.cart_promotion.campaign_id;','MAP',0,0,1,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 09:22:28','promotion_redemptions_fact_-552_promotion_redemptions_fact_-552_dim_campaign_id_-552','promotion_redemptions_fact_-552_dim_campaign_id','promotion_redemptions_fact_-552'),
(1683,47,'curr.promotion_activities_fact.earned_count := count(case curr.promotion_activities_fact.dim_promotion_activity_type_id = 1 then curr.promotion_activities_fact.id else null end);','NON_INC_REDUCE',0,0,0,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 09:22:28','promotion_activities_fact_-552_promotion_activities_fact_-552_earned_count_-552','promotion_activities_fact_-552_earned_count','promotion_activities_fact_-552'),
(1684,47,'curr.promotion_activities_fact.redeemed_count := count(case curr.promotion_activities_fact.dim_promotion_activity_type_id = 2 then curr.promotion_activities_fact.id else null end);','NON_INC_REDUCE',0,0,0,-552,'2021-10-12 23:51:57','2021-10-12 23:51:57','2021-11-30 09:22:28','promotion_activities_fact_-552_promotion_activities_fact_-552_redeemed_count_-552','promotion_activities_fact_-552_redeemed_count','promotion_activities_fact_-552'),
(1771,53,'curr.loyalty_benefits.dim_partner_program_id := dimension.benefits.program_id;','MAP',0,0,1,-562,'2020-10-04 11:48:00','2020-10-04 11:48:00','2021-11-30 09:22:28','loyalty_benefits_-562_loyalty_benefits_-562_dim_partner_program_id_-562','loyalty_benefits_-562_dim_partner_program_id','loyalty_benefits_-562'),
(1780,53,'curr.loyalty_benefits.dim_points_promotion_id := dimension.benefits.promotion_id;','MAP',0,0,1,-562,'2020-10-04 11:48:00','2020-10-04 11:48:00','2021-11-30 09:22:28','loyalty_benefits_-562_loyalty_benefits_-562_dim_points_promotion_id_-562','loyalty_benefits_-562_dim_points_promotion_id','loyalty_benefits_-562');

REPLACE INTO `fact_kpis` (`column_id`, `table_id`, `expression`, `type`, `is_reversible`, `primary_key_level`, `is_active`, `scope_id`, `last_computed_on`, `added_on`, `updated_on`, `column_id_str`, `table_id_str`, `id_str`) 
VALUES (913,54,'curr.fleet_users.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.fleet_users.auto_update_time_fleet_users/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-545,'2020-10-03 19:18:00','2020-10-03 19:18:00','2021-12-29 12:07:49','-1000_dim_latest_updated_date_id','fleet_users_-545','fleet_users_-545_-1000_dim_latest_updated_date_id_-545'),
(913,55,'curr.user_group_mapping.dim_latest_updated_date_id := cast(regexp_replace(DATE(from_unixtime(curr.user_group_mapping.auto_update_time_group_mapping/1000)), \'-\', \'\') as bigint );','MAP',0,0,1,-545,'2020-10-03 19:18:00','2020-10-03 19:18:00','2021-12-29 12:07:49','-1000_dim_latest_updated_date_id','user_group_mapping_-545','user_group_mapping_-545_-1000_dim_latest_updated_date_id_-545'),
(914,54,'curr.fleet_users.dim_latest_updated_time_id := HOUR(from_unixtime(curr.fleet_users.auto_update_time_fleet_users/1000)) * 60 + MINUTE(from_unixtime(curr.fleet_users.auto_update_time_fleet_users/1000))+1;','MAP',0,0,1,-545,'2020-10-03 19:18:00','2020-10-03 19:18:00','2021-12-29 12:07:49','-1000_dim_latest_updated_time_id','fleet_users_-545','fleet_users_-545_-1000_dim_latest_updated_time_id_-545'),
(914,55,'curr.user_group_mapping.dim_latest_updated_time_id := HOUR(from_unixtime(curr.user_group_mapping.auto_update_time_group_mapping/1000)) * 60 + MINUTE(from_unixtime(curr.user_group_mapping.auto_update_time_group_mapping/1000))+1;','MAP',0,0,1,-545,'2020-10-03 19:18:00','2020-10-03 19:18:00','2021-12-29 12:07:49','-1000_dim_latest_updated_time_id','user_group_mapping_-545','user_group_mapping_-545_-1000_dim_latest_updated_time_id_-545');

-- Dump completed on 2021-11-30 18:29:20
